<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no" />
    <meta name="google-site-verification" content="VXixwtxrf--qUV1swfStEg9jOGPKgUm6C3Ub_vouqmc" />
    <title>MecBar | The Mec Evolution </title>
    <link rel="icon" href="foto/favicon.ico"/>
   
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection" />
    <link href="https://fonts.googleapis.com/css?family=Raleway|Satisfy" rel="stylesheet">
    <link href="css/style.css" type="text/css" rel="stylesheet" media="screen,projection" />
 
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js" integrity="sha512-d9xgZrVZpmmQlfonhQUvTR7lMPtO7NkZMkA0ABN3PHCbKA5nqylQ/yWlFAyY6hYgdF1Qh6nYiuADWwKB4C2WSw==" crossorigin="anonymous"></script>
    <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script> 
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script> -->
   
    <!-- sumome  link social 
    <script src="//load.sumome.com/" data-sumo-site-id="98711fc4997a561007230296cfc67bf8fe083e4799bea5270763985560b583ec" async="async"></script>
     font x icone social + email -->
    <link rel="stylesheet" href="font-awesome/css/font-awesome.min.css">
    <!-- facebook open graph -->
    <meta property="og:url" content="https://www.mecbar.com" />
    <meta property="og:title" content="MecBar the web for you" />
    <meta property="og:image" content="https://www.mecbar.com/mecface.jpg" />
    <meta property="og:description" content="MecBar for you" />
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:ital@1&display=swap" rel="stylesheet"> 
    
</head>

 <nav>
        <li class="nav-wrapper back-home" id="head">
            <a href="https://www.mecbar.com/" class="aabrand-logo mecbar">
                <?xml version="1.0" encoding="UTF-8" standalone="no"?>
                <svg 
                   xmlns:osb="http://www.openswatchbook.org/uri/2009/osb"
                   xmlns:dc="http://purl.org/dc/elements/1.1/"
                   xmlns:cc="http://creativecommons.org/ns#"
                   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
                   xmlns:svg="http://www.w3.org/2000/svg"
                   xmlns="http://www.w3.org/2000/svg"
                   xmlns:xlink="http://www.w3.org/1999/xlink"
                   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
                   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
                   width="156"
                   height="64"
                   viewBox="0 0 12.3825 5.08"
                   version="1.1"
                   id="svg8"
                   inkscape:version="1.0 (6e3e5246a0, 2020-05-07)"
                   sodipodi:docname="mecbar.svg">
                  <defs
                     id="defs2">
                    <linearGradient
                       osb:paint="solid"
                       id="linearGradient2948">
                      <stop
                         id="stop2946"
                         offset="0"
                         style="stop-color:#c6126a;stop-opacity:1;" />
                    </linearGradient>
                    <linearGradient
                       osb:paint="solid"
                       id="linearGradient875">
                      <stop
                         id="stop873"
                         offset="0"
                         style="stop-color:#babd06;stop-opacity:1;" />
                    </linearGradient>
                    <linearGradient
                       id="linearGradient3253"
                       osb:paint="solid">
                      <stop
                         style="stop-color:#878734;stop-opacity:1;"
                         offset="0"
                         id="stop3251" />
                    </linearGradient>
                    <linearGradient
                       inkscape:collect="always"
                       id="linearGradient3093">
                      <stop
                         style="stop-color:#c6126a;stop-opacity:1;"
                         offset="0"
                         id="stop3089" />
                      <stop
                         style="stop-color:#c6126a;stop-opacity:0;"
                         offset="1"
                         id="stop3091" />
                    </linearGradient>
                    <linearGradient
                       id="linearGradient3071"
                       osb:paint="solid">
                      <stop
                         style="stop-color:#c6126a;stop-opacity:1;"
                         offset="0"
                         id="stop3069" />
                    </linearGradient>
                    <rect
                       x="38.182308"
                       y="80.104469"
                       width="51.135052"
                       height="30.274338"
                       id="rect18630" />
                    <rect
                       x="160.31746"
                       y="77.487633"
                       width="134.35785"
                       height="60.829021"
                       id="rect18624" />
                    <rect
                       x="70.354279"
                       y="28.223705"
                       width="103.27115"
                       height="64.638908"
                       id="rect18618" />
                    <rect
                       x="32.55666"
                       y="25.199898"
                       width="5.2916665"
                       height="43.089287"
                       id="rect18612" />
                    <rect
                       x="34.029621"
                       y="65.792862"
                       width="93.441322"
                       height="26.673161"
                       id="rect18606" />
                    <rect
                       x="10.284417"
                       y="19.486744"
                       width="193.27823"
                       height="129.88597"
                       id="rect18596" />
                    <linearGradient
                       inkscape:collect="always"
                       xlink:href="#linearGradient3093"
                       id="linearGradient3101"
                       gradientUnits="userSpaceOnUse"
                       x1="3.1346149"
                       y1="23.792595"
                       x2="78.606865"
                       y2="23.792595" />
                    <filter
                       height="1"
                       y="-2.5183475e-16"
                       width="1"
                       x="-7.1910066e-17"
                       style="color-interpolation-filters:sRGB"
                       inkscape:label="Blend"
                       id="filter3198">
                      <feBlend
                         in2="SourceGraphic"
                         mode="multiply"
                         result="fbSourceGraphic"
                         id="feBlend3196" />
                      <feColorMatrix
                         result="fbSourceGraphicAlpha"
                         in="fbSourceGraphic"
                         values="0 0 0 -1 0 0 0 0 -1 0 0 0 0 -1 0 0 0 0 1 0"
                         id="feColorMatrix3200" />
                      <feBlend
                         in2="fbSourceGraphic"
                         id="feBlend3202"
                         mode="multiply"
                         result="blend"
                         in="fbSourceGraphic" />
                      <feGaussianBlur
                         id="feGaussianBlur869"
                         stdDeviation="6.7542215e-15" />
                    </filter>
                    <linearGradient
                       gradientUnits="userSpaceOnUse"
                       y2="9.1505461"
                       x2="228.5569"
                       y1="9.1505461"
                       x1="3.1346149"
                       id="linearGradient2950"
                       xlink:href="#linearGradient2948"
                       inkscape:collect="always" />
                    <linearGradient
                       y2="9.1505461"
                       x2="228.5569"
                       y1="9.1505461"
                       x1="3.1346149"
                       gradientTransform="translate(2.3455617,-9.683066)"
                       gradientUnits="userSpaceOnUse"
                       id="linearGradient3064"
                       xlink:href="#linearGradient2948"
                       inkscape:collect="always" />
                  </defs>
                  <sodipodi:namedview
                     id="base"
                     pagecolor="#ffffff"
                     bordercolor="#666666"
                     borderopacity="1.0"
                     inkscape:pageopacity="0.0"
                     inkscape:pageshadow="2"
                     inkscape:zoom="0.7"
                     inkscape:cx="355.19772"
                     inkscape:cy="45.714286"
                     inkscape:document-units="mm"
                     inkscape:current-layer="layer1-6"
                     inkscape:document-rotation="0"
                     showgrid="false"
                     inkscape:window-width="1324"
                     inkscape:window-height="747"
                     inkscape:window-x="36"
                     inkscape:window-y="21"
                     inkscape:window-maximized="1"
                     units="px"
                     inkscape:snap-nodes="true"
                     inkscape:object-paths="true"
                     scale-x="0.3" />
                  <metadata
                     id="metadata5">
                    <rdf:RDF>
                      <cc:Work
                         rdf:about="">
                        <dc:format>image/svg+xml</dc:format>
                        <dc:type
                           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
                        <dc:title></dc:title>
                      </cc:Work>
                    </rdf:RDF>
                  </metadata>
                  <g
                     inkscape:label="Layer 1"
                     inkscape:groupmode="layer"
                     class="io"
                     id="layer1">
                    <rect
                       ry="7.1295023"
                       rx="10.726023"
                       y="-2.8428149"
                       x="-4.4855061"
                       height="21.245117"
                       width="20.103241"
                       id="rect2824"
                       style="opacity:0;fill:#c6126a;stroke:#babd06;stroke-width:0.0794996;stroke-opacity:0.00424254" />
                    <g
                       inkscape:label="Layer 1"
                       id="layer1-6"
                       transform="matrix(0.16152221,0.0020121,0,0.13626925,0.08059628,0.86541284)"
                       style="mix-blend-mode:normal;fill:url(#linearGradient2950);fill-opacity:1;stroke-width:6.74038;filter:url(#filter3198);image-rendering:optimizeQuality">
                      <text
                         xml:space="preserve"
                         id="text18594"
                         style="font-style:normal;font-weight:normal;font-size:10.5833px;line-height:125%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18596);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <text
                         xml:space="preserve"
                         style="font-style:oblique;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:25.0978px;line-height:125%;font-family:Purisa;-inkscape-font-specification:'Purisa, Oblique';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;letter-spacing:0px;word-spacing:0px;fill:url(#linearGradient3064);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
                         x="-4.0898471"
                         y="24.876211"
                         id="text18602"
                         transform="matrix(0.75566848,-0.20637119,0.34609071,1.2288151,0,0)"><tspan
                   sodipodi:role="line"
                   id="tspan18600"
                   x="-4.0898471"
                   y="24.876211"
                   style="font-style:oblique;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:25.0978px;font-family:Purisa;-inkscape-font-specification:'Purisa, Oblique';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;fill:url(#linearGradient3064);fill-opacity:1;stroke-width:1.78339px">MecBar</tspan>        <animate
                   style="fill-opacity:1;fill:url(#linearGradient3064)"
                   begin="0s;light_2.end"
                   dur="1s"
                   values="1;0"
                   attributeName="fill-opacity"
                   id="light_1" />       <animate
                   style="fill-opacity:1;fill:url(#linearGradient3064)"
                   begin="light_1.end"
                   dur="1s"
                   values="0;1"
                   attributeName="fill-opacity"
                   id="light_2" />           </text>
                      <text
                         xml:space="preserve"
                         id="text18604"
                         style="font-style:normal;font-weight:normal;font-size:10.5833px;line-height:125%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18606);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <text
                         xml:space="preserve"
                         id="text18610"
                         style="font-style:normal;font-weight:normal;font-size:10.5833px;line-height:125%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18612);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <text
                         xml:space="preserve"
                         id="text18616"
                         style="font-style:normal;font-weight:normal;font-size:10.5833px;line-height:125%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18618);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <text
                         xml:space="preserve"
                         id="text18622"
                         style="font-style:normal;font-weight:normal;font-size:10.5833px;line-height:125%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18624);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <text
                         xml:space="preserve"
                         id="text18628"
                         style="font-style:normal;font-weight:normal;font-size:12.7px;line-height:125%;font-family:sans-serif;text-align:justify;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18630);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <animate
                         style="fill-opacity:1;fill:url(#linearGradient2950)"
                         begin="0s;light_2.end"
                         dur="1s"
                         values="1;0"
                         attributeName="fill-opacity"
                         id="light_1" />
                      <animate
                         style="fill-opacity:1;fill:url(#linearGradient2950)"
                         begin="light_1.end"
                         dur="1s"
                         values="0;1"
                         attributeName="fill-opacity"
                         id="light_2" />
                    </g>
                    <rect
                       ry="7.1295042"
                       rx="10.726021"
                       y="-2.8428149"
                       x="-4.4855061"
                       height="16.413473"
                       width="25.987757"
                       id="rect871"
                       style="opacity:0;fill:#c6126a;stroke:#babd06;stroke-width:0.0794996;stroke-opacity:0.00424254" />
                  </g>
                  <style
                     id="style43">
                           #tspan18600 {
                               
                              animation-name: mecOpacity;
                              animation-duration: 2s;
                              animation-iteration-count: infinite;
                              }
                              @keyframes mecOpacity {
                              0%   { fill-opacity:1 }
                                50%  {fill-opacity :0.1; }
                            100% { fill-opacity: 1; }
                              }
                        </style>
                </svg>
             
              </a>
            <a href="#" data-activates="mobile-demo" class="button-collapse"><i class="material-icons">menu</i></a>

            <ul class="right hide-on-med-and-down">
              
              <li><a href="#block3">Blockchain</a></li>
                <li><a href="#quantum">Quantum</a></li>
                <li><a href="#ml">Machine Learning</a></li>
                <li><a href="#Ablog">Blog</a></li>
                <li><a href="#Adev">Develop</a></li>
                <li><a href="#AWindows">Windows</a></li>
                <li><a href="#Alinux">Linux</a></li>
                <li><a href="#Aus">Contatti</a></li>
                <li>
                    <a href=""> </a>
                </li>
                <li>
                    <a href=""> </a>
                </li>
            </ul>
            <ul class="side-nav" id="mobile-demo">
                <li><a href="#block3">Blockchain</a></li>
                <li><a href="#quantum">Quantum</a></li>
                <li><a href="#ml">Machine Learning</a></li>
                <li><a href="#Ablog">Blog</a></li> 
                <li> <a href="#Adev">Develop</a></li>
                <li><a href="#AWindows">Windows</a></li>
                <li><a href="#Alinux">Linux</a></li>
                <li><a href="#Aus">Contatti</a></li>
            </ul>
            </li>
</nav>
<style>
   canvas {
  position: relative;
  border: 2px solid rgba(222, 222, 248, 0.842);
  margin: 50px;
  background-color:black;
}
 .pred {
  border: 2px solid rgba(36, 36, 204, 0.842);
  padding:80px;
  background-color: #fff;
  color:black;
  font-size: 50px;
  line-height: 50px;
  text-align:center;
  vertical-align:middle;
height: 200px;
margin-top:50px;
margin-right: 50px;
 }
 .mlFlex {
    background-color:#fff;
    height : 400px;
 }
 .bottone:hover {
   box-shadow: 0 12px 16px 10px rgba(250, 250, 255, 0.616), 0 3px 5px 0 rgba(0, 0, 0, 0.19);
 }
 
 .fondo {
     padding-top:30px !important;
     padding:3% !important;
     font-size: 1.25rem;
     line-height: 1.5;
     text-align: left;
     font-family:  TT Norms,Helvetica,Arial;
    }
 .testa {
     color:#c6126a;
     font-family:  Tahoma, Arial;
     font-size: 22px;
 }
 .tit {
     color:#2d12c6;
     font-family:  Tahoma, Arial;
     font-size: 25px;
     margin-top: 30px;
     margin-bottom: 30px;
 }
 img {
     margin-top:20px;
     margin-bottom:20px;
 }

</style>
<body>
<div class="titolo">  Pillole di PowerShell </div>
<div class="fondo"> 
PowerShell include una CLI, shell con una riga di comando, un linguaggio di scripting e un framework per la gestione della configurazione 
PowerShell può essere eseguito in Windows, Linux e macOS.<br>
Qui vengono presentate alcune caratteristiche con degli esempi, iniziando dall'help.<br>
<span class="testa">Get-Command - Get-Help - Get-Member<br>
Get-help</span> con questo comando si ottengono i seguenti dati : NAME, SYNOPSIS, SYNTAX, DESCRIPTION, RELATED LINKS  e 
REMARKS<br>
<br>
<span class="testa">
Start-transcript </span> - registra un log con i comandi inseriti in un file di testa
<br>
<span class="testa">
Get-command -noun service</span>  -  elenco comandi con nome service<br>
<span class="testa">Get-service  *win*  </span>   - elenco servizi con nome inizia per win<br>

<span class="testa">Get-help get-service – online </span>  help online si apre finestra 

<span class="testa">Help *eventlog* </span>
<br>
<img src="foto/help.png" width="100%" height="300px"  >
<br>

Se cerco command – posso usare per abbreviare  <span class="testa"> gcm </span> 
<br>
<img src="foto/gcm.png" width="100%" height="300px">
<br>
Come usare l’help da PS o online:<br>
<img src="foto/help2.png" width="100%" height="400px"  >
<br>
<div class="tit">COME LEGGERE L'HELP </div> <br>
Il comando accetta 2 serie di parametri da usare in modo distinto :<br>
- i parametri possono essere comuni o separati – 
nel caso dei parametri separati se si usa uno di questi poi si possono usare solo i 
parametri inseriti in quel tipo ad esempio se si inserisce il parametro -List poi non
 si possono inserire i parametri  -LogName o -UserName presenti nella prima tipologia.<br>
 <span class="testa">Parametri opzionali</span>  -- inseriti tra le parentesi quadre [   ]<br>
 <span class="testa">Parametri obbligatori </span> :<br>
- Nell’esempio dell'immagine sopra esposto  -LogName è obbligatorio perchè è il primo parametro mentre -InstanceId è facoltativo perchè è racchiuso tra le [] 
- La presenza delle [] indica che si tratta di un positional parameter e se si omette il nome del parametro il comando lo prende in base alla posizione.
- Es. Get-eventlog system   - system è un parametro cioè -LogName <br>
- Es. Get-Eventlog -Logname system <br>
- Si possono inserire insieme positional parameter e parameter con nome ma attenzione alla posizione.<br>
- Es. Get-eventlog system -newest 20   ok <br>
- Es. Get.EvenLog -newest 50 -LogName system    ok perchè inserito il nome <br><br>
FULL HELP  -  <span class="testa">Help Get-EventLog -full </span>   <br>
<br>
Per ogni parametro si ha una ulteriore descrizione : <br>
<img src="foto/help3.png" width="100%" height="300px"><br>
-	Logname è obbligatorio e alla posizione valore di default si accetta * come carattere jolly
<img src="foto/help4.png" width="100%" height="300px"><br>
-	List è facoltativo e non lo si accetta come positional, non ha un valore di default e non accetta il caratteri jolly.<br>
-	Il tipo di parametro è indicato tra  <….><br>
-	String   < string >  o Int, Int32, or Int64  o DateTime  <br>
-   string[] accetta parametri array, collection or lista di stringhe quindi anche 1 sola stringa <br>
-   nelle liste si può inserire uno,due,tre o "uno", "due" o "tre" <br>
-	parametri anche tramite risultato function es. -Name (Get-content parametri.txt) mettendo le parentesi si forza l’esecuzione della funzione ed il risultato viene inserito come parametro.
<br>

- ottenere un esempio dall'help  <span class="testa">	Help Get-Eventlog -example </span><br>
<br>
- richiamare l'help online	<span class="testa">Help Get-EventLog -online </span><br>

<br><br>
<div class="tit">COMMAND NAME </div><br><br>
-	Cmdlet – naming convection – function – workflow – command – application <br>
-	Inizia per Get Set New Pause o alias <br>
<span class="testa"> get-alias </span> si ottengono gli alias dei comandi  <br><br>
<img src="foto/alias.JPG" width="100%" height="300px">
<br><br>
è possibile abbreviare le parole o usare il comando <span class="testa">show-command get-EventLog </span> <br>
si aprirà una finestra dove inserire i parametri e dopo averli inseriti si può lanciare il commando o copiare il commando ed inserirlo nella shell.
<br>
<img src="foto/showcommand.JPG" width="100%" height="350px">
<br><br>
<div class="tit">PROVIDERS</div><br><br>
è un adattatore che ci permette di vedere diverse risorse 
<br>
<img src="foto/providers.png" width="100%" height="300px">

<br><br>
Diverse capabilities :<br>
<br>-	ShouldProcess—Means the provider supports the use of the -WhatIf and -Confirm parameters, enabling you to “test” certain actions before committing to them. 
<br>-	Filter—Means the provider supports the -Filter parameter on the cmdlets that manipulate providers’ content. 
<br>-	Credentials—Means the provider permits you to specify alternate credentials when connecting to data stores. There’s a -credential parameter for this.
<br>-	Transactions—Means the provider supports the use of transactions, which allows you to use the provider to make several changes, and then either roll back or commit those changes as a single unit.
<br>
Permette la view di diversi data storage non solo su Filesystem :
<br>
<img src="foto/psdrive.png" width="100%" height="300px">
<br>
Per operare ci sono diversi comandi che si utilizzano su tutte le unità dei providers con il commando seguente vediamo un elenco dei comandi definiti per un item(può essere file, folders – qui non vengono nominati si usa solo item)
Ad esempio i Registry sono visti come filesystem perchè PS lo considera come un data-storage però poi nei comandi ci sono delle peculiarità da prendere in considerazione.
<br> 
- <span class="testa">get-command -noun *item* </span>   
<br>
<div class="tit">ITEM </div><br><br>

-	Verbs like Clear, Copy, Get, Move, New, Remove, Rename, and Set can all apply to items (like files and folders) as well as to item properties (such as the date the item was last written, or whether it’s read-only). <br>
-	The Item noun refers to individual objects, like files and folders. <br>
-	The ItemProperty noun refers to attributes of an item, such as read-only, creation time, length, and so on. <br>
-	The ChildItem noun refers to the items (like files and subfolders) contained within an item <br>
<br>
Operiamo ora su FileSystem :<br>
-	PS permette di usare i comandi sia dos che unix   --  vedere Get-alias<br>
<br>
-	Set-Location -Path C:\.....\....<br>
Per usare altro data storage  - ad esempio HKEY_CURRENT_USER:<br>
<img src="foto/hkcu.png" width="100%" height="300px"><br>
<br>
Altri providers possono essere – IIS e Sql Server 
<br><br>
<div class="tit">PIPELINE </div><br>
Ps permette tramite la pipeline di coniugare diversi comandi sulla stessa riga di commando.
<br>Vediamo il commando per esportare in csv o xml la lista dei processi :
<br>
<img src="foto/pipeline.png" width="70%" height="50px">
<br>
<img src="foto/pipeline2.png" width="70%" height="50px">
<br>
Export files :<br>
<img src="foto/export.png" width="50%" height="50px"><br>
<br>
Con out-file possiamo usare diversi parametri
<br>
<div class="tit">CHIEDERE CONFERMA O SIMULAZIONE COMANDI</div> 
<br>
Ora vediamo come è possibile operare sui processi/servizi 
<br>
<span class="testa">Get-Process -name winword | Stop-Process      o    Start-Process   [ -confirm ]  </span>
<br>
L’opzione -whatif ci dice cosa esegue il commando :
<br>
<img src="foto/whatif.png" width="70%" height="50px">
<br>
Per richiamare il contenuto del file :
<br>
<img src="foto/importfile.png" width="30%" height="40px">
<br><br>
<div class="tit">OGGETTI</div>
<br><br>
Ps è orientato agli oggetti per cui vengono presentati oggetti con metodi, propietà e function.
<br>
Es. Vediamo alcuni member dei processi filtrati con Name che iniziano per s <br>
<img src="foto/process.png" width="100%" height="450px">
<br>
Da notare il memberType e diversi tipi di property.<br>
SORT  -<span class="testa">Get-Process | Sort-Object -property VM </span> - 
 <span class="testa">Get-Process | Sort VM,ID -desc </span>
<br>
SELECT PROPERTY - <span class="testa">
Get-Process | Select-Object -property Name,ID,VM,PM | Out-File test2.txt</span>
<br><span class="testa">Get-Process | Select -First 10</span>
<br>
Mettere prima il select e poi il sort altrimenti si ha un risultato diverso.<br>
<span class="testa">Get-Process | Select Name,ID,VM  | Sort VM -descending |  gm </span><br>

<div class="tit">PASSAGGIO PARAMETRI TRAMITE LA PIPELINE  -- da  qui |   a qui </div> <br>
Primo metodo :<br>
-	pipeline input ByValue <br>
-	es. Get-process  xxxxxx |  stop-process 
-  stop-process attende il nome di un processo per cui il commando
 get-process deve aver come output un nome di un processo e per aver questo xxxxxx deve essere un filtro del commando get-process
 <br>
 <img src="foto/gm.png" width="100%" height="200px">
 <br>
 Mentre nell’help del comando stop-process troviamo :<br>
 <img src="foto/help_pipe.png" width="100%" height="350px">

 <br>
L'output del get-process è un oggetto del tipo process e il commando stop-process accetta in input un oggetto di tipo process e nella pipeline accetta valore ByValue.
Se non c’è corrispondenza prova con l’altro metodo byPropertyName
<br>
Parametri da file :<br>
-<span class="testa">Get-Service -computerName (Get-Content names.txt) </span><br>
<div class="tit">FILTER </div>
<img src="foto/filter.png" width="100%" height="200px">
<br>
Parameter : -filter   <br>
<br>
Comparazione :<br>
-eq—Equality, as in 5 -eq 5 (which is True) or "hello" -eq "help" (which is False) <br>
-ne—Not equal to, as in 10 -ne 5 (which is True) or "help" -ne "help" (which is False, because they’re, in fact, equal, and we were testing to see if they were unequal) <br>
-ge and -le—Greater than or equal to, and less than or equal to, as in 10 -ge 5 (True) or Get-Date -le '2012-12-02' (which will depend on when you run this, and shows how dates can be compared) <br>
-gt and -lt—Greater than and less than, as in 10 -lt 10 (False) or 100 -gt 10 (True)<br>
<br>
Per string :<br>
-ceq, -cne, -cgt, -clt, -cge, -cle <br>
<br>
$True e $False,  -and e -or,  -not ,  -like *s*  <br> 
The reverse is -notlike, and both are caseinsensitive; use -clike and -cnotlike
 for case-sensitive comparisons.<br>
-match makes a comparison between a string of text and a regular expression pattern. 
-notmatch is its logical opposite, and as you might expect, -cmatch and -cnotmatch 
provide case-sensitive versions. Regular expressions are beyond the scope of what
 we’ll cover in this book.<br>
 <br>
 <span class="testa">Get-Service | Where-Object -filter { $_.Status -eq 'Running' } </span>  <br>
<br>
<img src="foto/get_process.png" width="100%" height="300px"><br>
$_   placeholder  
<br>
<br>
<div class="tit">JOB </div> <br><br>
-	Get-job    -- lista job in esecuzione<br>
-	Multitasking  -  task scheduler <br>
<br>
<div class="tit">VARIABILI </div><br><br>

<img src="foto/variabili.png" width="100%" height="350px"><br>
altri 
<br>
<img src="foto/variabili2.png" width="100%" height="150px"><br>
<img src="foto/variabili3.png" width="100%" height="100px"><br>
Variabile all’interno di una stringa :<br>
<img src="foto/variabili4.png" width="100%" height="80px"><br>
<br>
<div class="tit">TIPI DI VARIABILI </div> <br>
[int]—Integer numbers <br>
[single] and [double]—Single-precision and double-precision floating numbers (numbers with a decimal portion) <br>
[string]—A string of characters <br>
[char]—Exactly one character (as in, [char]$c = 'X'<br>
[xml]—An XML document; whatever string you assign to this will be parsed to make sure it contains valid XML markup (for example, [xml]$doc = Get-Content MyXML.xml) <br>
[adsi]—An Active Directory Service Interfaces (ADSI) query; the shell will execute the query and place the resulting object or objects into the variable (such as [adsi]$user = "WinNT:\\MYDOMAIN\Administrator,user")<br>
<br>
<img src="foto/variabili5.png" width="100%" height="350px">
<br>
[char]$char = "A"         [string]$var = "abc" <br>
<br>
Comandi per operare con variabili :<br>
New-Variable <br>
Set-Variable <br>
Remove-Variable <br>
Get-Variable <br>
Clear-Variable<br>
<br>
<div class="tit">INPUT – OUTPUT </div> <br><br>
$var = read-host Iinserisci un nome"<br>
<img src="foto/var_input.png" width="100%" height="100px"><br>
<br>
Output  :  write-host  o write-output 
<br>
<br>
<div class="tit">SCRIPTING </div> <br><br>
<br>
Default value per parametri : assegno localhost come default <br>
param ( $computername = 'localhost' )  <br>
<#     Commenti<br>
.SINOPSIS<br>
.PARAMETER  computername  …….. <br>
.DESCRIPTION ..<br>
#><br>
<br>
PIPELINE <br>negli script tutti i comandi nella stessa pipeline <br>
Get-service<br>
Get-process<br>

Nella stessa pipeline mentre nella shell ogni commando opera in una sua pipeline questo porta a risultati diversi.
<br>
SCOPE   - global scope    -- script scope  ( all’interno di questa ci sono function scope )<br>
<br>
[CmdletBinding()]   deve essere primo commando nello script <br>
Per rendere obbligatorio il parametro :<br>
[CmdletBinding()] <br>
param ( <br>
[Parameter(Mandatory=$True)]<br>
[string]$computername,     la , indica che I parametri devono essere divisi da una virgola es- ./myScript  param1, param2 <br>
[int]$numeroDrive = 2 ) <br>
<br>

Operators: -as, -is, -replace, -join, -split, -in, -contains<br>
<br>
Per gestire errori : <br>
{ <br>
 try <br>
{  }<br>
 catch <br>
{    }<br>
}<br>
<br><br>
<div class="tit"> ARRAY </div> <br>
Definizione : <br>
<br>
<img src="foto/array.png" width="100%" height="150px"><br>
Access element – modify element – add element<br>
<img src="foto/array2.png" width="100%" height="300px"><br>
Array sort <br>
<img src="foto/array3.png" width="100%" height="150px"><br>
Find element<br>
<img src="foto/array4.png" width="100%" height="100px"><br>
MultiDimensional array   -- 1 x 3<br>
<img src="foto/array5.png" width="100%" height="300px"><br>
Array List – definizione ed operazioni <br>
<img src="foto/array6.png" width="100%" height="500px"><br>
<br>
<div class="tit">DICTIONARY </div><br>
<img src="foto/dictionary.png" width="100%" height="300px"><br>
Non si può inserire una key già esistente. Si riceve un errore. 
<br>
<img src="foto/dictionary2.png" width="100%" height="300px"><br>
<br>
Ricordiamoci sempre il get-member per vedere i metodi e le proprietà :<br>
<img src="foto/dictionary3.png" width="100%" height="500px"><br>


<br>

Get-alias<br>
Get-process<br>
Get-process -name Microsoft <br>
get-process -name brave | get-member<br>
get-process -name brave | get-member<br>
PS C:\> $a = get-process -name brave<br>
PS C:\> $a<br>
$+ nome è una varibile<br>
PS C:\> $b =get-process -name brave<br>
PS C:\> $b.Id     --  view property solo una alla volta<br>
$b.kill()   -- chiude processo <br>
Get-history<br>
Get-psdrive   -- dati disco locale<br>
Alias    -- Get-alias  --  ? = where-object<br>
$_ è current object in pipeline <br>
<br>
<div class="tit">COMANDI CON DECORATORI </div>
get-psdrive | ? { $_.free -gt 10} | select-object  Root  - dischi con free space > 10 <br>
get-psdrive | ? { $_.free -gt 10} | foreach-object  free   - spazio libero dove > 10000 <br>

<img src="foto/spazio.png" width="100%" height="100px"><br>

et-psdrive | ? { $_.free -gt 10} | foreach-object  { write-host "Spazio Libero " $_.root 'is' $_.free -ForegroundColor blue}<br>
Free space for C:\ is ……<br>
Free space for D:\ is ……<br>
<br>
get-psdrive | ? { $_.free -gt 10} | foreach-object 
 { write-host "Free space for" $_.root 'is' ($_.free /1024) -ForegroundColor red}<br>
Free space for C:\ is .....<br>
Free space for D:\ is ......<br>
<span class="testa"> "{0:N2}" -f 100<br>
100.00<br>
 "{0:c2}" -f 100<br>
£100.00<br>
 "{0:p2}" -f 100<br>
10,000.00%<br>
<br></span>
get-psdrive | ? { $_.free -gt 10} | foreach-object  { write-host "Free space for" $_.root 'is' ("{0:N3}" -f ($_.free /1024)) -ForegroundColor red}<br>
Free space for C:\ is .....<br>
Free space for D:\ is .....<br>
<br>
<div class="tit">CICLO </div> <br> 
<br>
get-psdrive | ? { $_.free -gt 10} | foreach-object  { $c = 0; write-host "primo giro" } {$c = $c + 1 ;write-host "giro dopo"  $c } {write-host " fine  "  $c }<br>
primo giro<br>
giro dopo 1<br>
giro dopo 2<br>
 fine   2<br>

 <br><br>
foreach-object  se in console cli
<br>
foreach in script       <br>
<br>
2 metodi diversi stesso risultato :<br>
<br>
- $Service = 'w32time'; Get-Service -Name $Service   <br>
<br>
- Get-Service | Where-Object Name -eq w32time<br>
<br>
Creare una nuova directory. Si può comunque usare il vecchio Mkdir.<br>
get-volume<br>
new-item -Itemtype Directory "Log"<br>
<img src="foto/nuovadir.PNG" width="100%" height="250px"><br>
<div class="tit"> ITERATORI</div>

<div class="tit">CICLO FOR </div> 

for ($i = 1; $i -lt 5; $i++) {<br>
  Write-Output "Sleeping for $i seconds"<br>
  Start-Sleep -Seconds $i<br>
}<br>

<div class="tit">DO e DO … WHILE </div>  
$number = Get-Random -Minimum 1 -Maximum 10<br>
do {<br>
  $guess = Read-Host -Prompt "What's your guess?"<br>
  if ($guess -lt $number) {<br>
    Write-Output 'Too low!'<br>
  } elseif ($guess -gt $number) {<br>
    Write-Output 'Too high!'<br>
  }<br>
}<br>
while ($guess -ne $number)
<br>
<div class="tit">WHILE </div>  <br>
<br>
while ($i -lt 5) {<br>
  $i += 1<br>
  if ($i -eq 3) {<br>
    continue<br>
  }<br>
  Write-Output $i<br>
}<br>

<br>
Break, Continue, and Return<br>
<div class="tit"> COPY  </div> 
PS C:\Users\mecba\onedrive\desktop\ps1> copy-item  *.xlsx  C:\Users\mecba\onedrive\desktop\ps2 -recurse<br>
-recurse  per copiare tutti file presenti – <br>
-force<br>
Copy con rename file <br>
copy-item  *.xlsx  C:\Users\mecba\onedrive\desktop\ps2\nuovo.xlsx -recurse<br>
<br>
<div class="tit"> MOVE  </div>  
Move-item  se file già presente    -force<br>
<br>
<div class="tit"> DELETE </div>  
PS C:\Users\mecba\onedrive\desktop\ps2> remove-item *.xlsx -whatif<br>
What if: Performing the operation "Remove File" on target "C:\Users\mecba\onedrive\desktop\ps2\nuovo.xlsx".<br>
What if: Performing the operation "Remove File" on target "C:\Users\mecba\onedrive\desktop\ps2\Power_BI_DIRTYDATA.xlsx".<br>
Get-location   es. $loc = get-location <br>
Set-location    es. $loc = set-location -Path c:\users\mecba\onedrive\desktop\ps1 -passthru<br>
Push-location<br>
<br>
<div class="tit">  RENAME </div>   
Get-ChildItem *.log | Rename-Item -NewName { $_.Name -replace '.log','.txt' }<br>
<br>

<div class="tit"> Creare funzioni personali in file     funzioni.psm1 </div>  
<br>
-	Mentre script  nome_file.ps1 <br>
<img src="foto/personal_function.png" width="100%" height="150px"><br>

<br>
get-help *pin*   <br>
<img src="foto/personal_function2.png" width="100%" height="100px"><br>
<br>

PS C:\Users\mecba\onedrive\desktop> $env:PSModulePath -split ";"<br>
C:\Users\mecba\OneDrive\Documents\WindowsPowerShell\Modules   creo  directory <br>  
C:\Program Files\WindowsPowerShell\Modules<br>
C:\Windows\system32\WindowsPowerShell\v1.0\Modules<br>
<br>
import-module pingo -force -verbose     --- per sicurezza bloccato import ed executing <br>
<br>
<br>
-	Se si inseriscono muduli nel percorso sopra li trova in automatico senza inserire il path <br>
Esempio <br>
<br>
FILE  .psm1 <br>
function p {<br>
    <br>
   param($computername)<br>
   return (test-connection $computername -count 3 -quit)<br>
   <br>
   }<br>
   <br>

File PS1<br>
Import-Module -Name C:\Users\mecba\OneDrive\Desktop\myFunc.psm1 -Verbose<br>
write-host "Hello my Friend"<br>
$input = Read-Host "Inserisci indirizzo da pingare" <br>
$ping = p $input<br>
write-host  “risultato – l’indirizzo risponde …. “ $ping<br>
sleep 10<br>
<br>
<br>

lista directory into file  e visione :<br>
<br>
get-childitem > dir.txt   <br>
get-content dir.txt<br>
<br>
get-childitem | out-file ./directory.txt<br>
<br><br>


get-help  get-service -showwindow<br>
<br>
get-service bits   o  get-service b*    o   gsv b*<br>

<br>
$error  = Get-ChildItem -Path C:\Test\*.txt <br>
<br>
If $err != ""   -- manda mail <br>
<br>

Get-service -name bits  | stop-service <br>
Get-service -name bits  | start-service <br>
Notepad  <br>
Calc <br>
<br>
Get-process | Export-clixml -Path c:\process.xml     export in xml<br>
Get-service | out-file -Filepath c:\service.txt<br>
Get-service | convertTo-csv <br>
<br>
Get-service | convertTo-html Out-File c:\serv.html <br>
<br>
Get-content  c:\service.txt<br>
<br>

Compare-object<br>
<br><br>
<div class="tit"> OBJECT </div>   <br>
<br>
Get-service | select -Property <br>
<div class="tit"> SELECT METHOD  </div>  <br>
Get-childitem | select -property name, length   | sort  -property length   - visualizza solo name e length 
<br>


-	Get-history <br>
Uso alias <br>
<br>
Get-service | where { $_.status -eq "running"  -and $_.name  -like "b*"}<br>
<br>
poWershell remoting <br>
<br>
.\nomeScript<br>

<br>


<div class="tit">SCRIPT CREARE FILE CSV </div>  <br>
<br>
$outfile = "C:\Outfile.csv"<br>
$csv = {} | Select "Id","City", "State" | Export-Csv $outfile<br>
<br>
$csvfile.Id = "10001"<br>
$csvfile.City = "London"<br>
$csvfile.State = "U.K."<br>
$csvfile | Export-CSV $outfile  <br>
$csvfile.Id = "10002"<br>
$csvfile.City = "Rome"<br>
$csvfile.State = "Italy"<br>
<br>
$csvfile | Export-CSV $outfile  -Append <br>
<br>
<img src="foto/pscreacsv.png" width="100%" height="350px">
<br>
<div class="tit"> CONCATENARE DIVERSI FILE CSV SIMILI IN UN NUOVO FILE CSV  </div>
<br>
<span class="testa">
get-childItem  -filter "*.csv"  | Select-Object -ExpandProperty Name | import-csv | out-file nuovofile.csv 
<br>
import-csv nuovofile.csv | out-Host </span>
<br>
<div class="tit"> CONCATENARE DIVERSI FILE CSV SIMILI IN UN NUOVO FILE HTML </div>
<span class="testa">
get-childItem  -filter "*.csv"  | Select-Object -ExpandProperty Name | import-csv | ConvertTo-Html | out-file nuovofile.html 
</span>
<br>
<div class="tit"> READ FILES  AND RENAME FILES </div>

<br>
<img src="foto/renamefile.png" width="100%" height="100px">

<div class="tit"> ROBOCOPY  </div>  <br><br>
<br>
Robocopy  source  destination   /L       non copia nulla ma fa lista file con dimensione
<br>

Robocopy  source dest   -  copia tutto
<br>
Robocopy source dest  *.doc   -  copi tutti file .doc
<br>
 
<div class="tit">  SCRIPT   </div> <br>
Es.  Lista con numero files into zip archive
<br>
$ZipRoot = 'C:\users\mecba\onedrive\desktop\pec'<br>
$tipofile = '.csv'<br>
$Count = 0<br>
$riga = ''<br>
$spazio = ' ' <br>
<br>
$ZipFiles = Get-ChildItem -Path $ZipRoot -Recurse -Filter '*.zip'<br>
#Write-Host "zipfile ", $ZipFiles[0]<br>
<br>
$Shell = New-Object -ComObject Shell.Application<br>
#Write-Host "zip ", $ZipFiles[0].FullName<br>
$Results = foreach( $ZipFile in $ZipFiles ){<br>
    <br>
    $Count += $Shell.NameSpace($ZipFile.FullName).Items() |<br>
        Where-Object { $_.Name -match $tipofile } |<br>
        Measure-Object |<br>
        Select-Object -ExpandProperty Count<br>
    Write-Host "Archive  ", $ZipFile ,"  Count= ", $Count<br>
    $riga = [System.String]::Concat($ZipFile , $spazio,$Count)  | out-file -append 'lista files.txt'
    <br>
    $Count = 0<br>
    }<br>
write-Host 'Fine   '  <br>
<br>

<div class="tit"> COMPUTER INFORMATION </div>  <br><br>

Get-counter   - help   -- <br>
<br>
get-wmiobject  -list  *<br>
<br>
get-cimclass -className *memory*  <br>

<br>
<img src="foto/psesempio.png" width="100%" height="150px">

<br>
get-NetIPAddress<br>
<br>
get-NetIPConfiguration<br>
<br>
gsm get-dns* 
<br>
get-DnsClient <br>
get-dnsclientserverAddress<br>
<br>
Commando per vedere eventi di Sistema in questo caso 1074 – riavvio Sistema – <br>
Get-EventLog -log system -newest 1000 | ? { $_.eventid -eq '1074' } | format-table machinename, username, timegenerated -autosize
<br>
<img src="foto/eventlog.JPG" width="100%" height="150px"><br>
get-computerInfo *memory*<br>
<br>
<img src="foto/psmemory.JPG" width="100%" height="200px">
<br>

</body>
</html>