
<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0" />
    <meta name="google-site-verification" content="VXixwtxrf--qUV1swfStEg9jOGPKgUm6C3Ub_vouqmc" />
    <title>MecBar | The Mec Evolution </title>
    <link rel="icon" href="foto/favicon.ico"/>
    <!-- CSS  -->
    <link href="css/style.css" type="text/css" rel="stylesheet" media="screen,projection" />
    <link href="css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection" />
    
    <script src="js/jquery-3.js"></script>
    
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
   
    <link href="https://fonts.googleapis.com/css?family=Raleway|Satisfy" rel="stylesheet">
   

    <link href="css/style2.css" type="text/css" rel="stylesheet" media="screen,projection" />
    <link href="css/navbar.css" type="text/css" rel="stylesheet" media="screen,projection" />
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:ital@1&display=swap" rel="stylesheet"> 
</head>
<header>
    <nav>
        <li class="nav-wrapper back-home" id="head">
            <a href="http://www.mecbar.com/" class="brand-logo mecbar">
                <?xml version="1.0" encoding="UTF-8" standalone="no"?>
                <svg
                   xmlns:osb="http://www.openswatchbook.org/uri/2009/osb"
                   xmlns:dc="http://purl.org/dc/elements/1.1/"
                   xmlns:cc="http://creativecommons.org/ns#"
                   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
                   xmlns:svg="http://www.w3.org/2000/svg"
                   xmlns="http://www.w3.org/2000/svg"
                   xmlns:xlink="http://www.w3.org/1999/xlink"
                   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
                   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
                   width="156"
                   height="64"
                   viewBox="0 0 12.3825 5.08"
                   version="1.1"
                   id="svg8"
                   inkscape:version="1.0 (6e3e5246a0, 2020-05-07)"
                   sodipodi:docname="mecbar.svg">
                  <defs
                     id="defs2">
                    <linearGradient
                       osb:paint="solid"
                       id="linearGradient2948">
                      <stop
                         id="stop2946"
                         offset="0"
                         style="stop-color:#c6126a;stop-opacity:1;" />
                    </linearGradient>
                    <linearGradient
                       osb:paint="solid"
                       id="linearGradient875">
                      <stop
                         id="stop873"
                         offset="0"
                         style="stop-color:#babd06;stop-opacity:1;" />
                    </linearGradient>
                    <linearGradient
                       id="linearGradient3253"
                       osb:paint="solid">
                      <stop
                         style="stop-color:#878734;stop-opacity:1;"
                         offset="0"
                         id="stop3251" />
                    </linearGradient>
                    <linearGradient
                       inkscape:collect="always"
                       id="linearGradient3093">
                      <stop
                         style="stop-color:#c6126a;stop-opacity:1;"
                         offset="0"
                         id="stop3089" />
                      <stop
                         style="stop-color:#c6126a;stop-opacity:0;"
                         offset="1"
                         id="stop3091" />
                    </linearGradient>
                    <linearGradient
                       id="linearGradient3071"
                       osb:paint="solid">
                      <stop
                         style="stop-color:#c6126a;stop-opacity:1;"
                         offset="0"
                         id="stop3069" />
                    </linearGradient>
                    <rect
                       x="38.182308"
                       y="80.104469"
                       width="51.135052"
                       height="30.274338"
                       id="rect18630" />
                    <rect
                       x="160.31746"
                       y="77.487633"
                       width="134.35785"
                       height="60.829021"
                       id="rect18624" />
                    <rect
                       x="70.354279"
                       y="28.223705"
                       width="103.27115"
                       height="64.638908"
                       id="rect18618" />
                    <rect
                       x="32.55666"
                       y="25.199898"
                       width="5.2916665"
                       height="43.089287"
                       id="rect18612" />
                    <rect
                       x="34.029621"
                       y="65.792862"
                       width="93.441322"
                       height="26.673161"
                       id="rect18606" />
                    <rect
                       x="10.284417"
                       y="19.486744"
                       width="193.27823"
                       height="129.88597"
                       id="rect18596" />
                    <linearGradient
                       inkscape:collect="always"
                       xlink:href="#linearGradient3093"
                       id="linearGradient3101"
                       gradientUnits="userSpaceOnUse"
                       x1="3.1346149"
                       y1="23.792595"
                       x2="78.606865"
                       y2="23.792595" />
                    <filter
                       height="1"
                       y="-2.5183475e-16"
                       width="1"
                       x="-7.1910066e-17"
                       style="color-interpolation-filters:sRGB"
                       inkscape:label="Blend"
                       id="filter3198">
                      <feBlend
                         in2="SourceGraphic"
                         mode="multiply"
                         result="fbSourceGraphic"
                         id="feBlend3196" />
                      <feColorMatrix
                         result="fbSourceGraphicAlpha"
                         in="fbSourceGraphic"
                         values="0 0 0 -1 0 0 0 0 -1 0 0 0 0 -1 0 0 0 0 1 0"
                         id="feColorMatrix3200" />
                      <feBlend
                         in2="fbSourceGraphic"
                         id="feBlend3202"
                         mode="multiply"
                         result="blend"
                         in="fbSourceGraphic" />
                      <feGaussianBlur
                         id="feGaussianBlur869"
                         stdDeviation="6.7542215e-15" />
                    </filter>
                    <linearGradient
                       gradientUnits="userSpaceOnUse"
                       y2="9.1505461"
                       x2="228.5569"
                       y1="9.1505461"
                       x1="3.1346149"
                       id="linearGradient2950"
                       xlink:href="#linearGradient2948"
                       inkscape:collect="always" />
                    <linearGradient
                       y2="9.1505461"
                       x2="228.5569"
                       y1="9.1505461"
                       x1="3.1346149"
                       gradientTransform="translate(2.3455617,-9.683066)"
                       gradientUnits="userSpaceOnUse"
                       id="linearGradient3064"
                       xlink:href="#linearGradient2948"
                       inkscape:collect="always" />
                  </defs>
                  <sodipodi:namedview
                     id="base"
                     pagecolor="#ffffff"
                     bordercolor="#666666"
                     borderopacity="1.0"
                     inkscape:pageopacity="0.0"
                     inkscape:pageshadow="2"
                     inkscape:zoom="0.7"
                     inkscape:cx="355.19772"
                     inkscape:cy="45.714286"
                     inkscape:document-units="mm"
                     inkscape:current-layer="layer1-6"
                     inkscape:document-rotation="0"
                     showgrid="false"
                     inkscape:window-width="1324"
                     inkscape:window-height="747"
                     inkscape:window-x="36"
                     inkscape:window-y="21"
                     inkscape:window-maximized="1"
                     units="px"
                     inkscape:snap-nodes="true"
                     inkscape:object-paths="true"
                     scale-x="0.3" />
                  <metadata
                     id="metadata5">
                    <rdf:RDF>
                      <cc:Work
                         rdf:about="">
                        <dc:format>image/svg+xml</dc:format>
                        <dc:type
                           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
                        <dc:title></dc:title>
                      </cc:Work>
                    </rdf:RDF>
                  </metadata>
                  <g
                     inkscape:label="Layer 1"
                     inkscape:groupmode="layer"
                     class="io"
                     id="layer1">
                    <rect
                       ry="7.1295023"
                       rx="10.726023"
                       y="-2.8428149"
                       x="-4.4855061"
                       height="21.245117"
                       width="20.103241"
                       id="rect2824"
                       style="opacity:0;fill:#c6126a;stroke:#babd06;stroke-width:0.0794996;stroke-opacity:0.00424254" />
                    <g
                       inkscape:label="Layer 1"
                       id="layer1-6"
                       transform="matrix(0.16152221,0.0020121,0,0.13626925,0.08059628,0.86541284)"
                       style="mix-blend-mode:normal;fill:url(#linearGradient2950);fill-opacity:1;stroke-width:6.74038;filter:url(#filter3198);image-rendering:optimizeQuality">
                      <text
                         xml:space="preserve"
                         id="text18594"
                         style="font-style:normal;font-weight:normal;font-size:10.5833px;line-height:125%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18596);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <text
                         xml:space="preserve"
                         style="font-style:oblique;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:25.0978px;line-height:125%;font-family:Purisa;-inkscape-font-specification:'Purisa, Oblique';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;letter-spacing:0px;word-spacing:0px;fill:url(#linearGradient3064);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
                         x="-4.0898471"
                         y="24.876211"
                         id="text18602"
                         transform="matrix(0.75566848,-0.20637119,0.34609071,1.2288151,0,0)"><tspan
                   sodipodi:role="line"
                   id="tspan18600"
                   x="-4.0898471"
                   y="24.876211"
                   style="font-style:oblique;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:25.0978px;font-family:Purisa;-inkscape-font-specification:'Purisa, Oblique';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;fill:url(#linearGradient3064);fill-opacity:1;stroke-width:1.78339px">MecBar</tspan>        <animate
                   style="fill-opacity:1;fill:url(#linearGradient3064)"
                   begin="0s;light_2.end"
                   dur="1s"
                   values="1;0"
                   attributeName="fill-opacity"
                   id="light_1" />       <animate
                   style="fill-opacity:1;fill:url(#linearGradient3064)"
                   begin="light_1.end"
                   dur="1s"
                   values="0;1"
                   attributeName="fill-opacity"
                   id="light_2" />           </text>
                      <text
                         xml:space="preserve"
                         id="text18604"
                         style="font-style:normal;font-weight:normal;font-size:10.5833px;line-height:125%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18606);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <text
                         xml:space="preserve"
                         id="text18610"
                         style="font-style:normal;font-weight:normal;font-size:10.5833px;line-height:125%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18612);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <text
                         xml:space="preserve"
                         id="text18616"
                         style="font-style:normal;font-weight:normal;font-size:10.5833px;line-height:125%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18618);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <text
                         xml:space="preserve"
                         id="text18622"
                         style="font-style:normal;font-weight:normal;font-size:10.5833px;line-height:125%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18624);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <text
                         xml:space="preserve"
                         id="text18628"
                         style="font-style:normal;font-weight:normal;font-size:12.7px;line-height:125%;font-family:sans-serif;text-align:justify;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18630);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <animate
                         style="fill-opacity:1;fill:url(#linearGradient2950)"
                         begin="0s;light_2.end"
                         dur="1s"
                         values="1;0"
                         attributeName="fill-opacity"
                         id="light_1" />
                      <animate
                         style="fill-opacity:1;fill:url(#linearGradient2950)"
                         begin="light_1.end"
                         dur="1s"
                         values="0;1"
                         attributeName="fill-opacity"
                         id="light_2" />
                    </g>
                    <rect
                       ry="7.1295042"
                       rx="10.726021"
                       y="-2.8428149"
                       x="-4.4855061"
                       height="16.413473"
                       width="25.987757"
                       id="rect871"
                       style="opacity:0;fill:#c6126a;stroke:#babd06;stroke-width:0.0794996;stroke-opacity:0.00424254" />
                  </g>
                  <style
                     id="style43">
                           #tspan18600 {
                               
                              animation-name: mecOpacity;
                              animation-duration: 2s;
                              animation-iteration-count: infinite;
                              }
                              @keyframes mecOpacity {
                              0%   { fill-opacity:1 }
                                50%  {fill-opacity :0.1; }
                            100% { fill-opacity: 1; }
                              }
                    </style>
                </svg>
                </a>
            <a href="#" data-activates="mobile-demo" class="button-collapse"><i class="material-icons">menu</i></a>

            <ul class="right hide-on-med-and-down">
                <!--  <li> <a class="btn" onclick="Materialize.toast('Hello', 4000, 'Ciao' ,4000 )">Touch Me</a> </li>
              -->

              <li><a href="http://www.mecbar.com/#Ablog">Blog</a></li>
              <li><a href="http://www.mecbar.com/#Ablock">Blockchain</a></li>
              <li><a href="http://www.mecbar.com/#quantum">Quantum</a></li>
              <li><a href="http://www.mecbar.com/#Amachine">Machine Learning</a></li>
              <li><a href="http://www.mecbar.com/#Alinux">Linux</a></li>
              <li><a href="http://www.mecbar.com/#Aus">Contatti</a></li>
                <li>
                    <a href=""> </a>
                </li>
                <li>
                    <a href=""> </a>
                </li>
            </ul>
          
              <ul class="side-nav" id="mobile-demo">
               <li><a href="http://www.mecbar.com/#Ablog">Blog</a></li>
              <li><a href="http://www.mecbar.com/#Ablock">Blockchain</a></li>
                 <li><a href="http://www.mecbar.com/#quantum">Quantum</a></li>
              <li><a href="http://www.mecbar.com/#Amachine">Machine Learning</a></li>
              <li><a href="http://www.mecbar.com/#Alinux">Linux</a></li>
              <li><a href="http://www.mecbar.com/#Aus">Contatti</a></li>
            </ul>
        
            </li>
    </nav>
</header>
<style>
    .tasto-su {
            position: fixed;
            bottom: 15px;
            right: 5px;
            padding: 8px;
            background: rgb(6, 29, 160);
            color: white;
            border-radius: 20px;
            display:block;
            cursor: pointer;
            z-index: 5;
        }
   .tasto-su:hover {
            background:rgb(24, 2, 122);
            color :rgb(251, 173, 25);
        }

</style>
<script>
    MathJax = {
      loader: {load: ['input/asciimath', 'output/chtml']}
    }
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<body>
<div class="center titolo">
    <i>Clustering clienti di una Banca per Marketing con K-Means - PCA - AutoEncoder  </i>
 </div>
 <div class="testo">
In questo post vediamo come suddividere la clientela di una banca in base ai dati a disposizione della banca 
per promuovere operazioni di marketing. 
Una descrizione dei dati usati per la simulazione si trova in fondo alla pagina **. 
<br>
<div class="row">
 <div class="col l6 m12 s12">   
<img src="foto/autoencodergra.png" width="100%" height="400px"><br><br>
 </div>
 <div class="col l6 m12 s12">   
L'elaborazione si compone di 3 fasi.
La prima inizia con la predisposizione dei dati da elaborare, qui prendiamo i dati più rappresentativi e 
trasformato i dati non numerici in codici numerici.
Appena i dati sono pronti tramite il modello di Deep Learning <b><i>AutoEncoder</i></b> riduciamo la tipologia di dati da 8 a 5. 
<br>
La seconda fase consiste, in base ai 5 parametri rimasti, nel trovare il numero di cluster da creare. 
Qui usiamo l'algoritmo K-Means e per decidere quanti cluster creare disegniamo il grafico dell'Elbow method da cui 
prendiamo 3 come valore dei cluster ottimali.<br>
A questo punto creiamo i 3 cluster ed inseriamo in un DataFrame per ogni cliente il relativo cluster di 
appartenenza.<br> 
</div>
</div>
La terza fase consiste nel viasualizzare i cluster ottenuti in un grafico da cui possiamo valutare la validità 
del risultato raggiunto essendo i punti di ogni cluster concentrati vicino al relativo centro senza dispersioni. 
<br>
<br>
Vediamo i primi e gli ultimi record del DataFrame creato con i dati in input.<br><br>
<img src="foto/bank.png" width="100%" height="300px">
<br><br>
Qui vediamo il DataFrame dopo aver tolto le ultime colonne e la conversione dei valori 
non numerici in codici numerici.
<br>
<br>
<img src="foto/bank2.png" width="70%" height="200px">
<br><br>

Iniziamo il programma con l'import delle librerie necessarie per eseguire quanto descritto sopra e la presentazione dei risultati.<br><br>
<div class="model77">
%matplotlib inline<br>
import pandas as pd<br>
from datetime import date, timedelta<br>
import keras<br>
keras.backend.clear_session()<br>
from matplotlib.widgets import TextBox<br>
from sklearn.impute import SimpleImputer <br>
from sklearn.preprocessing import StandardScaler<br>
from sklearn.decomposition import PCA<br>
from tensorflow.keras.layers import Input, Dense<br>
from tensorflow.keras.models import Model, load_model,Sequential<br>
from keras.optimizers import SGD<br>
from collections import Counter
</div>
<div class="model77">
import numpy as np<br>
import matplotlib.pyplot as plt<br>
from sklearn import cluster<br>
from matplotlib import cm,colors<br>
</div>
<div class="model77">
def doKmeans(X, nclust):<br>
<span style="margin-left:30px">   model = KMeans(n_clusters= nclust)</span><br>
<span style="margin-left:30px">   model.fit(X)</span><br>
<span style="margin-left:30px">   clust_labels = model.predict(X)</span><br>
 <span style="margin-left:30px">  cent = model.cluster_centers_</span><br>
 <span style="margin-left:30px"> return (clust_labels, cent)</span><br>
</div>

Normalizzazione dei valori in input per velocizzare i calcoli.
<div class="model77">
sc = StandardScaler()<br>
X_scaled = sc.fit_transform(bank2)<br>
</div>
Definizione del modello di Autoencoder. Inserendo 10 hidden layer, l'input con shape 8, 
il risultato dell'encoder è di shape 5 che è l'input del decoder con risultato di 8. Segue la 
compilazione con l'optimizer e la funzione di loss.  
<div class="model77">
hidden_dim = 10<br>
<br>
input = Input(shape=(8,))<br>
<br>

enc = Dense(hidden_dim, activation='relu')(input)<br>
enc = Dense(1500, activation='relu')(enc)<br>
enc = Dense(1500, activation='relu')(enc)<br>
enc = Dense(1500, activation='relu')(enc)<br>
<br>
encoded = Dense(5, activation='relu')(enc)<br>
<br>
dec = Dense(1500, activation='relu')(encoded)<br>
dec = Dense(1500, activation='relu')(dec)<br>
<br>
decoded = Dense(8)(dec)<br>
<br>
# autoencoder<br>
autoencoder = Model(datadf, decoded)<br>
<br>
# usato per riduzione componenti<br>
encoder = Model(datadf, encoded)<br>

autoencoder.compile(optimizer= 'adam', loss='mean_squared_error')
</div>
Ora eseguiamo il modello inserendo in input i dati normalizzati. Al termine 
otteniamo il modello con il sommario dove notiamo che 
il modello ha utilizzato quasi 6 milioni e ottocentomila parametri. 

<div class="model77">
autoencoder.fit(X_scaled, X_scaled, batch_size = 32, epochs = 20)<br><br>

autoencoder.summary()
<br><br><br>
<img class="imgm" src="foto/autoencoder.png" width="60%" height="300px">
<br>
</div>
Ora utilizziamo il modello encoder per predirre il risultato ottenuto inserendo in input 
i dati normalizzati. Così otteniamo come si vede nel riquadro sottostante la riduzione dei dati in input da shape 
8 a 5. 
<div class="model77">
pred = encoder.predict(X_scaled)<br><br>
pred.shape <br>
<br><br>
shape di pred : (45211, 5) 
</div>
Passiamo alla fase successiva utilizzando l'algoritmo KMeans per ottenere i dati 
che con il metodo Elbow possiamo scegliere il numero di cluster ottimale. 

<div class="model77">
wcss = []<br>

for i in range(1,pred.shape[1]):<br>
<span style="margin-left:30px"> kmeans = KMeans(n_clusters = i, init ='k-means++', random_state=0)</span><br>
<span style="margin-left:30px">kmeans.fit(pred)</span><br>
<span style="margin-left:30px"> wcss.append(kmeans.inertia_) # valori per determinare cluster</span><br>
  <br><br>
plt.plot(range(1,pred.shape[1]), wcss,'bx-')<br>
plt.title('The Elbow Method')<br>
plt.xlabel('Number of cluster')<br>
plt.ylabel('Inertia')
</div>
Il grafico sottostante mostra The Elbow Method dove possiamo notare che il numero di 
clister ottimale è 3.
<br><br><br>
<img src="foto/elbow.png" width="60%" height="300px">
<br><br><br>
La fase successiva consiste nell'assegnazione tramite l'algoritmo K-Means del cluster per ogni cliente 
e l'inserimento del numero cluster nel DataFrame. Calcoliamo anche il numero di clienti appartenenti a ciascun cluster.

<div class="model77">
clust_labels, centro = doKmeans(pred, 3)<br>
kmeans = pd.DataFrame(clust_labels)<br>
# aggiungo colonna df iniziale con cluster<br>
bank2.insert((bank2.shape[1]),'kmeans',kmeans)<br>

<br>
numeropercluster = Counter(clust_labels) 
<br><br>
Counter({1: 31362, 2: 7145, 0: 6704})<br>
<br>
</div>
Vediamo il DataFrame aggiornato con il cluster assegnato.
<br><br>
<img class="imgm" src="foto/bank3.png" width="70%" height="300px"><br><br>
Ora utilizziamo il Principal component analysis (PCA) un algoritmo di riduzione lineare della dimensionalità<div class="">
 Con questo algoritmo utilizziamo solo 2 componenti, i più rappresentativi, creando un DataFrame 
 con i dati ottenuti.  
</div>

<div class="model77">
pca = PCA(n_components = 2)<br>
pca_data = pca.fit_transform(pred)<br>
pcadf = pd.DataFrame(data=pca_data, columns=['comp1', 'comp2'])<br>
pcadf = pd.concat([pcadf, pd.DataFrame({'cluster': kmeans[0]})],axis=1)   #kmeans   cluster definito con kmeans 
<br><br>

fig = px.scatter(pcadf, x='comp1', y='comp2', color=pcadf['cluster'])<br>
fig.show()
</div>
<br>
Grafico dei 3 cluster creati con K-Means. 
<br>
<img class="imgm" src="foto/pcaplot.png" width="100%" height="400px">
<br>
<br>

Con gli stessi dati senza procedere ad una riduzione dei dati tramite il modello AutoEncoder 
con Kmeans avevamo un elbow di 5 cioè 5 cluster e dopo aver eseguito la PCA per avere una  
percentuale di rappresentatività vicina al 50% si dovevano utilizzare 3 componenti. 
Nell'immagine sottostante vediamo una rappresentazione in 3D dei cluster creati. 
Possiamo concludere che riducendo i dati con Autoencoder non solo non perdiamo rappresentatività ma 
riusciamo anche ad avere un numero minore di cluster. 
<br><br>
Grafico 3d con 5 cluster.
<br><br>
<img class="imgm" src="foto/pcaplot3d.png" width="100%" height="300px">
<br>
<br>
<br>

** <br>
<div class="terminal" style="font-size:15px">
The data is related with direct marketing campaigns of a Portuguese banking institution.<br>
<br>

The marketing campaigns were based on phone calls. Often, more than one contact to the same client was required, in order to access if the product (bank term deposit) would be (or not) subscribed.
The bank dataset with all examples from May 2008 to November 2010 has 45211 instances.
The classification goal is to predict if the client will subscribe a product of the bank the term deposit (variable y).
The dataset has 16 + output attribute our dependent variable.<br>

The input attribute are our independent variables:<br>
# bank client data:<br>
1 - age (numeric)<br>
2 - job : type of job (categorical: "admin.","unknown","unemployed","management","housemaid","entrepreneur","student", "blue-collar","self-employed","retired","technician","services")<br>
3 - marital : marital status (categorical: "married","divorced","single"; note: "divorced" means divorced or widowed)<br>
4 - education (categorical: "unknown","secondary","primary","tertiary")<br>
5 - default: has credit in default? (binary: "yes","no")<br>
6 - balance: average yearly balance, in euros (numeric)<br>
7 - housing: has housing loan? (binary: "yes","no")<br>
8 - loan: has personal loan? (binary: "yes","no") # related with the last contact of the current campaign:<br>
9 - contact: contact communication type (categorical: "unknown","telephone","cellular")<br>
10 - day: last contact day of the month (numeric)<br>
11 - month: last contact month of year (categorical: "jan", "feb", "mar", ..., "nov", "dec")<br>
12 - duration: last contact duration, in seconds (numeric)<br>
13 - campaign: number of contacts performed during this campaign and for this client (numeric, includes last contact)<br>
14 - pdays: number of days that passed by after the client was last contacted from a previous campaign (numeric, -1 means client was not previously contacted)<br>
15 - previous: number of contacts performed before this campaign and for this client (numeric)<br>
16 - poutcome: outcome of the previous marketing campaign (categorical: "unknown","other","failure","success") Output variable (desired target):<br>
17 - y - has the client subscribed a term deposit? (binary: "yes","no")<br>
For the project we use the following file granted from UCI Machine Learning Repository :<br>
[Moro et al., 2011] S. Moro, R. Laureano and P. Cortez. Using Data Mining for Bank Direct Marketing:
 An Application of the CRISP-DM Methodology. In P. Novais et al. (Eds.), Proceedings of the European 
 Simulation and Modelling Conference - ESM'2011, pp. 117-121, Guimarães, Portugal, October, 2011. EUROSIS. Available at: 
 [pdf] http://hdl.handle.net/1822/14838 [bib] http://www3.dsi.uminho.pt/pcortez/bib/2011-esm-1.txt 

</div>
</div>
</body>
</html>