<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0" />
    <meta name="google-site-verification" content="VXixwtxrf--qUV1swfStEg9jOGPKgUm6C3Ub_vouqmc" />
    <title>MecBar | The Mec Evolution </title>
    <link rel="icon" href="foto/favicon.ico"/>
    <!-- CSS  -->
    <link href="css/style.css" type="text/css" rel="stylesheet" media="screen,projection" />
    <link href="css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection" />
    
    <script src="js/jquery-3.js"></script>
    
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
   
    <link href="https://fonts.googleapis.com/css?family=Raleway|Satisfy" rel="stylesheet">
   

    <link href="css/style2.css" type="text/css" rel="stylesheet" media="screen,projection" />
    <link href="css/navbar.css" type="text/css" rel="stylesheet" media="screen,projection" />
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:ital@1&display=swap" rel="stylesheet"> 
</head>
<header>
    <nav>
        <li class="nav-wrapper back-home" id="head">
            <a href="http://www.mecbar.com/" class="brand-logo mecbar">
                <?xml version="1.0" encoding="UTF-8" standalone="no"?>
                <svg
                   xmlns:osb="http://www.openswatchbook.org/uri/2009/osb"
                   xmlns:dc="http://purl.org/dc/elements/1.1/"
                   xmlns:cc="http://creativecommons.org/ns#"
                   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
                   xmlns:svg="http://www.w3.org/2000/svg"
                   xmlns="http://www.w3.org/2000/svg"
                   xmlns:xlink="http://www.w3.org/1999/xlink"
                   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
                   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
                   width="156"
                   height="64"
                   viewBox="0 0 12.3825 5.08"
                   version="1.1"
                   id="svg8"
                   inkscape:version="1.0 (6e3e5246a0, 2020-05-07)"
                   sodipodi:docname="mecbar.svg">
                  <defs
                     id="defs2">
                    <linearGradient
                       osb:paint="solid"
                       id="linearGradient2948">
                      <stop
                         id="stop2946"
                         offset="0"
                         style="stop-color:#c6126a;stop-opacity:1;" />
                    </linearGradient>
                    <linearGradient
                       osb:paint="solid"
                       id="linearGradient875">
                      <stop
                         id="stop873"
                         offset="0"
                         style="stop-color:#babd06;stop-opacity:1;" />
                    </linearGradient>
                    <linearGradient
                       id="linearGradient3253"
                       osb:paint="solid">
                      <stop
                         style="stop-color:#878734;stop-opacity:1;"
                         offset="0"
                         id="stop3251" />
                    </linearGradient>
                    <linearGradient
                       inkscape:collect="always"
                       id="linearGradient3093">
                      <stop
                         style="stop-color:#c6126a;stop-opacity:1;"
                         offset="0"
                         id="stop3089" />
                      <stop
                         style="stop-color:#c6126a;stop-opacity:0;"
                         offset="1"
                         id="stop3091" />
                    </linearGradient>
                    <linearGradient
                       id="linearGradient3071"
                       osb:paint="solid">
                      <stop
                         style="stop-color:#c6126a;stop-opacity:1;"
                         offset="0"
                         id="stop3069" />
                    </linearGradient>
                    <rect
                       x="38.182308"
                       y="80.104469"
                       width="51.135052"
                       height="30.274338"
                       id="rect18630" />
                    <rect
                       x="160.31746"
                       y="77.487633"
                       width="134.35785"
                       height="60.829021"
                       id="rect18624" />
                    <rect
                       x="70.354279"
                       y="28.223705"
                       width="103.27115"
                       height="64.638908"
                       id="rect18618" />
                    <rect
                       x="32.55666"
                       y="25.199898"
                       width="5.2916665"
                       height="43.089287"
                       id="rect18612" />
                    <rect
                       x="34.029621"
                       y="65.792862"
                       width="93.441322"
                       height="26.673161"
                       id="rect18606" />
                    <rect
                       x="10.284417"
                       y="19.486744"
                       width="193.27823"
                       height="129.88597"
                       id="rect18596" />
                    <linearGradient
                       inkscape:collect="always"
                       xlink:href="#linearGradient3093"
                       id="linearGradient3101"
                       gradientUnits="userSpaceOnUse"
                       x1="3.1346149"
                       y1="23.792595"
                       x2="78.606865"
                       y2="23.792595" />
                    <filter
                       height="1"
                       y="-2.5183475e-16"
                       width="1"
                       x="-7.1910066e-17"
                       style="color-interpolation-filters:sRGB"
                       inkscape:label="Blend"
                       id="filter3198">
                      <feBlend
                         in2="SourceGraphic"
                         mode="multiply"
                         result="fbSourceGraphic"
                         id="feBlend3196" />
                      <feColorMatrix
                         result="fbSourceGraphicAlpha"
                         in="fbSourceGraphic"
                         values="0 0 0 -1 0 0 0 0 -1 0 0 0 0 -1 0 0 0 0 1 0"
                         id="feColorMatrix3200" />
                      <feBlend
                         in2="fbSourceGraphic"
                         id="feBlend3202"
                         mode="multiply"
                         result="blend"
                         in="fbSourceGraphic" />
                      <feGaussianBlur
                         id="feGaussianBlur869"
                         stdDeviation="6.7542215e-15" />
                    </filter>
                    <linearGradient
                       gradientUnits="userSpaceOnUse"
                       y2="9.1505461"
                       x2="228.5569"
                       y1="9.1505461"
                       x1="3.1346149"
                       id="linearGradient2950"
                       xlink:href="#linearGradient2948"
                       inkscape:collect="always" />
                    <linearGradient
                       y2="9.1505461"
                       x2="228.5569"
                       y1="9.1505461"
                       x1="3.1346149"
                       gradientTransform="translate(2.3455617,-9.683066)"
                       gradientUnits="userSpaceOnUse"
                       id="linearGradient3064"
                       xlink:href="#linearGradient2948"
                       inkscape:collect="always" />
                  </defs>
                  <sodipodi:namedview
                     id="base"
                     pagecolor="#ffffff"
                     bordercolor="#666666"
                     borderopacity="1.0"
                     inkscape:pageopacity="0.0"
                     inkscape:pageshadow="2"
                     inkscape:zoom="0.7"
                     inkscape:cx="355.19772"
                     inkscape:cy="45.714286"
                     inkscape:document-units="mm"
                     inkscape:current-layer="layer1-6"
                     inkscape:document-rotation="0"
                     showgrid="false"
                     inkscape:window-width="1324"
                     inkscape:window-height="747"
                     inkscape:window-x="36"
                     inkscape:window-y="21"
                     inkscape:window-maximized="1"
                     units="px"
                     inkscape:snap-nodes="true"
                     inkscape:object-paths="true"
                     scale-x="0.3" />
                  <metadata
                     id="metadata5">
                    <rdf:RDF>
                      <cc:Work
                         rdf:about="">
                        <dc:format>image/svg+xml</dc:format>
                        <dc:type
                           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
                        <dc:title></dc:title>
                      </cc:Work>
                    </rdf:RDF>
                  </metadata>
                  <g
                     inkscape:label="Layer 1"
                     inkscape:groupmode="layer"
                     class="io"
                     id="layer1">
                    <rect
                       ry="7.1295023"
                       rx="10.726023"
                       y="-2.8428149"
                       x="-4.4855061"
                       height="21.245117"
                       width="20.103241"
                       id="rect2824"
                       style="opacity:0;fill:#c6126a;stroke:#babd06;stroke-width:0.0794996;stroke-opacity:0.00424254" />
                    <g
                       inkscape:label="Layer 1"
                       id="layer1-6"
                       transform="matrix(0.16152221,0.0020121,0,0.13626925,0.08059628,0.86541284)"
                       style="mix-blend-mode:normal;fill:url(#linearGradient2950);fill-opacity:1;stroke-width:6.74038;filter:url(#filter3198);image-rendering:optimizeQuality">
                      <text
                         xml:space="preserve"
                         id="text18594"
                         style="font-style:normal;font-weight:normal;font-size:10.5833px;line-height:125%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18596);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <text
                         xml:space="preserve"
                         style="font-style:oblique;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:25.0978px;line-height:125%;font-family:Purisa;-inkscape-font-specification:'Purisa, Oblique';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;letter-spacing:0px;word-spacing:0px;fill:url(#linearGradient3064);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
                         x="-4.0898471"
                         y="24.876211"
                         id="text18602"
                         transform="matrix(0.75566848,-0.20637119,0.34609071,1.2288151,0,0)"><tspan
                   sodipodi:role="line"
                   id="tspan18600"
                   x="-4.0898471"
                   y="24.876211"
                   style="font-style:oblique;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:25.0978px;font-family:Purisa;-inkscape-font-specification:'Purisa, Oblique';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;fill:url(#linearGradient3064);fill-opacity:1;stroke-width:1.78339px">MecBar</tspan>        <animate
                   style="fill-opacity:1;fill:url(#linearGradient3064)"
                   begin="0s;light_2.end"
                   dur="1s"
                   values="1;0"
                   attributeName="fill-opacity"
                   id="light_1" />       <animate
                   style="fill-opacity:1;fill:url(#linearGradient3064)"
                   begin="light_1.end"
                   dur="1s"
                   values="0;1"
                   attributeName="fill-opacity"
                   id="light_2" />           </text>
                      <text
                         xml:space="preserve"
                         id="text18604"
                         style="font-style:normal;font-weight:normal;font-size:10.5833px;line-height:125%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18606);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <text
                         xml:space="preserve"
                         id="text18610"
                         style="font-style:normal;font-weight:normal;font-size:10.5833px;line-height:125%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18612);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <text
                         xml:space="preserve"
                         id="text18616"
                         style="font-style:normal;font-weight:normal;font-size:10.5833px;line-height:125%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18618);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <text
                         xml:space="preserve"
                         id="text18622"
                         style="font-style:normal;font-weight:normal;font-size:10.5833px;line-height:125%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18624);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <text
                         xml:space="preserve"
                         id="text18628"
                         style="font-style:normal;font-weight:normal;font-size:12.7px;line-height:125%;font-family:sans-serif;text-align:justify;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18630);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <animate
                         style="fill-opacity:1;fill:url(#linearGradient2950)"
                         begin="0s;light_2.end"
                         dur="1s"
                         values="1;0"
                         attributeName="fill-opacity"
                         id="light_1" />
                      <animate
                         style="fill-opacity:1;fill:url(#linearGradient2950)"
                         begin="light_1.end"
                         dur="1s"
                         values="0;1"
                         attributeName="fill-opacity"
                         id="light_2" />
                    </g>
                    <rect
                       ry="7.1295042"
                       rx="10.726021"
                       y="-2.8428149"
                       x="-4.4855061"
                       height="16.413473"
                       width="25.987757"
                       id="rect871"
                       style="opacity:0;fill:#c6126a;stroke:#babd06;stroke-width:0.0794996;stroke-opacity:0.00424254" />
                  </g>
                  <style
                     id="style43">
                           #tspan18600 {
                               
                              animation-name: mecOpacity;
                              animation-duration: 2s;
                              animation-iteration-count: infinite;
                              }
                              @keyframes mecOpacity {
                              0%   { fill-opacity:1 }
                                50%  {fill-opacity :0.1; }
                            100% { fill-opacity: 1; }
                              }
                    </style>
                </svg>
                </a>
            <a href="#" data-activates="mobile-demo" class="button-collapse"><i class="material-icons">menu</i></a>

            <ul class="right hide-on-med-and-down">
                <!--  <li> <a class="btn" onclick="Materialize.toast('Hello', 4000, 'Ciao' ,4000 )">Touch Me</a> </li>
              -->

              <li><a href="http://www.mecbar.com/#Ablog">Blog</a></li>
              <li><a href="http://www.mecbar.com/#Ablock">Blockchain</a></li>
              <li><a href="http://www.mecbar.com/#quantum">Quantum</a></li>
              <li><a href="http://www.mecbar.com/#Amachine">Machine Learning</a></li>
              <li><a href="http://www.mecbar.com/#Windows">Windows</a></li>
              <li><a href="http://www.mecbar.com/#Alinux">Linux</a></li>
              <li><a href="http://www.mecbar.com/#Aus">Contatti</a></li>
                <li>
                    <a href=""> </a>
                </li>
                <li>
                    <a href=""> </a>
                </li>
            </ul>
          
              <ul class="side-nav" id="mobile-demo">
               <li><a href="http://www.mecbar.com/#Ablog">Blog</a></li>
              <li><a href="http://www.mecbar.com/#Ablock">Blockchain</a></li>
                 <li><a href="http://www.mecbar.com/#quantum">Quantum</a></li>
              <li><a href="http://www.mecbar.com/#Amachine">Machine Learning</a></li>
              <li><a href="http://www.mecbar.com/#Windows">Windows</a></li>
              <li><a href="http://www.mecbar.com/#Alinux">Linux</a></li>
              <li><a href="http://www.mecbar.com/#Aus">Contatti</a></li>
            </ul>
        
            </li>
    </nav>
</header>
<style>
    .quad {
        margin-top:50px;
        margin-bottom:50px; 
        border-radius: 5px;
        border : 1px solid rgba(218, 223, 230, 0.945);
        color :rgba(10, 10, 10, 0.925);
        text-align: left;
        background-color:#ffffffef ;
    }
    .testo1{
        padding: 20px;
        margin-top:50px;
        margin-bottom:50px; 
        border-radius: 20px;
        border : 1px solid rgba(57, 139, 247, 0.945);
        color :rgba(22, 22, 24, 0.925);
        text-align: left;
        font-size:12px;
        line-height:14px;
        background-color:#ecebeb ;
    }
    img {
        margin-bottom: 30px;
    }
</style>

<body>
<div class="center titolo">
    <i> LINEAR REGRESSION</i>
 </div>
 <div class="testo">

Con la linear regression possiamo fare previsioni creando un modello avendo una variabile indipendente(x) ed una 
variabile dipendente(y). La formula è la seguente : <br>
Y = a + bX <br>
per cui inserendo un valore per la varibile x automaticamente otteniamo la previsione di y.<br>

Per ottenere un modello abbiamo a disposizione molti metodi e qui prenderemo in considerazione i più importanti. 

 I modelli che saranno creati ci permetteranno di predire il prezzo delle case a Taiwan in base al report seguente fornito da :
 <div class="testo1">
 Yeh, I. C., & Hsu, T. K. (2018). Building real estate valuation models with comparative approach through case-based reasoning. Applied Soft Computing, 65, 260-271.
<br> 
I dati sono inerenti :<br> 
The market historical data set of real estate valuation are collected from Sindian Dist., New Taipei City, Taiwan.<br>

I dati in input sono :<br> 
X1=the transaction date (for example, 2013.250=2013 March, 2013.500=2013 June, etc.)<br> 
X2=the house age (unit: year)<br> 
X3=the distance to the nearest MRT station (unit: meter)<br> 
X4=the number of convenience stores in the living circle on foot (integer)<br> 
X5=the geographic coordinate, latitude. (unit: degree)<br> 
X6=the geographic coordinate, longitude. (unit: degree)<br> 
<br> 
output :<br> 
Y= house price of unit area (10000 New Taiwan Dollar/Ping, where Ping is a local unit, 1 Ping = 3.3 meter squared) 
 </div>

Dopo aver importato le librerie passiamo a preparare il file con i dati di input.

<div class="quad">
import numpy as np<br> 
import matplotlib.pyplot as plt<br> 
import pandas as pd<br> 
from sklearn.model_selection import cross_val_score<br> 
from sklearn.metrics import classification_report , plot_confusion_matrix , confusion_matrix<br> 
from sklearn.impute  import SimpleImputer<br> 
from sklearn.preprocessing import StandardScaler<br> 
from sklearn.decomposition import PCA<br> 
from sklearn.model_selection import train_test_split<br> 
from sklearn.metrics import mean_squared_error, r2_score<br> 
from sklearn.linear_model import LinearRegression<br> 
<br> 
%matplotlib inline<br> 
</div>


<div class="quad">
data = pd.read_csv('/content/drive/MyDrive/dati/Real estate valuation data set.csv')<br> 
</div>
Sotto un estratto del file caricato nel dataframe data.
<br> <br> 
<img src="foto/linear0.png" width="100%" height="350px"><br> 
<br> <br> 
Nel dataframe in caso di campi vuoti inseriamo degli zeri.

<div class="quad">

    sistemavuoti = SimpleImputer(missing_values=np.nan, strategy='constant', fill_value=0)<br> 
    sistemavuoti.fit_transform(data)<br> 
</div>
Estrazioni dei dati dal dataframe con x - dati in input e y - dati in output   
<div class="quad">
    X = data.iloc[:,1:-1]<br> 
    y = data.iloc[:,-1]<br> 
</div>
Creazione del training set e del test set. Con pca selezioniamo quale è il parametro con maggiore 
correlazione con l'output poi per agevolare i calcoli si scala training e test set si individua nome 
della colonna selezionata per l'input.

<div class="quad">
x_train, x_test, y_train, y_test = train_test_split(X, y, test_size = 0.2, random_state = 0)<br> 

pca = PCA(n_components=1)<br> 
pca.fit(x_train)<br> 
x_train = pca.transform(x_train)<br> 

x_test = pca.transform(x_test)<br> 

sc = StandardScaler()<br> 

x_train = sc.fit_transform(x_train)<br> 
x_test = sc.fit_transform(x_test)<br> 

headerI = [ x for x in X.columns  ] # header input <br> 

comp = pca.n_components_<br> 

index_comp = [np.abs(pca.components_[i]).argmax() for i in range(comp)]<br> # cerco index columns selezionata 

input = headerI[index_comp[0]]<br>
</div>
<b>LINEAR REGRESSION</b>

<div class="quad">

    reg = LinearRegression()<br> 
    reg.fit(x_train,y_train)<br> 
    y_pred = reg.predict(x_test)<br> 
</div>

 <div class="quad">
    y_test1 = y_test.astype(float)<br> 
    y_test1.dtype<br> 
    <br> 
    color = [ 'red']<br> 
    title = {'fontsize': 20 ,<br> 
      'color' : 'blue',<br> 
     'verticalalignment': 'baseline',<br> 
     'horizontalalignment': 'center'}<br> 
     <br> 
    reg.score<br> 
    print('Coefficients: ', reg.coef_,  '\n')<br> 
    print('Mean squared error: %.2f'   % mean_squared_error(y_test, y_pred), '\n')<br> 
    print('Coefficient of determination(R2 score): %.2f' % r2_score(y_test, y_pred), '\n')<br> 
    <br> 
    
    # Plot <br> 
    plt.scatter(x_test,y_test,  color= color )<br> 
    plt.plot(x_test, y_pred, 'b+' , linewidth=1)<br> 
    plt.title('House Price Prediction', fontdict=title )<br> 
    plt.xticks([x_test.min(),x_test.mean(),x_test.max()])<br> 
    plt.yticks([y.min(),y.mean(),y.max()])<br> 
    plt.xlabel(input)<br> 
    plt.ylabel(data.columns[-1])<br> 
    <br> 
    plt.show()<br> 
 </div>
 <img src="foto/linear1.png" width="70%" height="450px"><br> <br> 

 <b>RIDGE REGRESSION</b>
 <div class="quad">
    from sklearn.linear_model import Ridge <br> 
    reg = Ridge(alpha=.5) <br> 
    <br> 
    reg.fit(x_train,y_train) <br> 
    y_pred = reg.predict(x_test) <br> 
    print('Coefficients: ', reg.coef_,  '\n') <br> 
    print('intercept_: ', reg.intercept_,  '\n') <br> 
    #con GridSearchCV  calcolare alpha migliore  <br> 
    <br> 
    plt.scatter(x_test,y_test,  color= color ) <br> 
    plt.plot(x_test, y_pred, 'b-' , linewidth=1) <br> 
    plt.title('House Price Prediction', fontdict=title ) <br> 
    plt.xticks([x_test.min(),x_test.mean(),x_test.max()]) <br> 
    plt.yticks([y.min(),y.mean(),y.max()]) <br> 
    plt.xlabel(input) <br> 
    plt.ylabel(data.columns[-1]) <br> 
    <br> 
    plt.show() <br> 

 </div>
 <img src="foto/linear2.png" width="70%" height="350px"><br>  

 <b>LASSO REGRESSION</b>

 <div class="quad">

    from sklearn.linear_model import LassoCV <br> 
    reg = LassoCV(cv=10, random_state=0).fit(x_train, y_train) <br> 
    reg.score(x_train,y_train) <br> 
    y_pred = reg.predict(x_test) <br> 
     
    print('Coefficients: ', reg.coef_,  '\n') <br> 
    model = 'LassoCV' <br> 
    plt.scatter(x_test,y_test,  color= color ) <br> 
    plt.plot(x_test, y_pred, 'b-' , linewidth=1) <br> 
    plt.title('House Price Prediction %s' % model, fontdict=title ) <br> 
    plt.xticks([x_test.min(),x_test.mean(),x_test.max()]) <br> 
    plt.yticks([y.min(),y.mean(),y.max()]) <br> 
    plt.xlabel(input) <br> 
    plt.ylabel(data.columns[-1]) <br> 
    <br> 
    plt.show() <br> 


 </div>
 <img src="foto/lasso.png" width="70%" height="350px"><br>  

 <b>BAYESIANRIDGE REGRESSION</b>
 <div class="quad">
    reg = linear_model.BayesianRidge() <br> 
    reg.fit(x_train, y_train) <br> 
    print('Coefficients: ', reg.coef_,  '\n') <br> 
    y_pred = reg.predict(x_test) <br> 
    model = 'BayesianRidge' <br> 
    plt.scatter(x_test,y_test,  color= color ) <br> 
    plt.plot(x_test, y_pred, 'b-' , linewidth=1) <br> 
    plt.title('House Price Prediction %s' % model, fontdict=title ) <br> 
    plt.xticks([x_test.min(),x_test.mean(),x_test.max()]) <br> 
    plt.yticks([y.min(),y.mean(),y.max()]) <br> 
    plt.xlabel(input) <br> 
    plt.ylabel(data.columns[-1]) <br> 
    <br> 
    plt.show() <br> 
 </div>
 <img src="foto/BayesianRidge.png" width="70%" height="350px"><br> 

 <b>SGD REGRESSION</b>
 <div class="quad">
    from sklearn.linear_model import SGDRegressor <br> 
    <br> 
    sgd = SGDRegressor() <br> 
    
    sgd.fit(x_train,y_train) <br> 
    
    print('Coefficients: ', sgd.coef_,  '\n') <br> 
    
    y_pred = reg.predict(x_test) <br> 
    model = 'SGDRegressor' <br> 
    plt.scatter(x_test,y_test,  color= color ) <br> 
    plt.plot(x_test, y_pred, 'b-' , linewidth=1) <br> 
    plt.title('House Price Prediction %s' % model, fontdict=title ) <br> 
    plt.xticks([x_test.min(),x_test.mean(),x_test.max()]) <br> 
    plt.yticks([y.min(),y.mean(),y.max()]) <br> 
    plt.xlabel(input) <br> 
    plt.ylabel(data.columns[-1]) <br> 
    <br> 
    plt.show() <br> 


 </div>
 <img src="foto/sgdreg.png" width="70%" height="350px"><br> 

 <b>SUPPORT VECTOR MACHINE REGRESSION - LINEAR / RBF / POLINOMIAL</b>
 <div class="quad">
    from sklearn.svm import SVR <br> 
    <br> 
    # Fit regression model <br> 
    <br> 
    svrL = SVR(kernel='linear', C=100, gamma='auto') <br> 
    svrK = SVR(kernel='rbf', C=100, gamma=0.1, epsilon=.1) <br> 
    svrP = SVR(kernel='poly', C=100, gamma='auto', degree=3, epsilon=.1, coef0=1) <br> 
    <br> 
def plotSvr(model, svr): <br> 
<span style="margin-left:30px">fig, axes = plt.subplots(nrows=1, ncols=1, figsize=(12, 10), sharey=True)</span><br>
<span style="margin-left:30px"> axes.plot(x_test, svr.fit(x_train, y_train).predict(x_test), 'bo' ,color='red', lw=1, label='{} predicted '.format( model ))</span><br>
<span style="margin-left:30px"> axes.scatter(x_train, y_train, facecolor="None",</span><br>
 <span style="margin-left:60px">edgecolor='black', s=40,</span><br>
 <span style="margin-left:60px">label='{} training set '.format( model))</span><br>
  
 <span style="margin-left:30px">axes.legend(loc='upper center', bbox_to_anchor=(0.5, 1.1),</span><br>
 <span style="margin-left:60px">ncol=1, fancybox=True, shadow=True)</span><br>
  
  <span style="margin-left:30px">fig.text(0.5, 0.04, input, ha='center', va='center')</span><br>
    <span style="margin-left:30px">fig.text(0.06, 0.5, data.columns[-1], ha='center', va='center', rotation='vertical')</span><br>
   <span style="margin-left:30px">fig.suptitle("House Price Prediction with Support Vector Regression " +  model , fontsize=16) </span><br>
 <span style="margin-left:30px">plt.show()</span><br>
  
 </div>



 <div class="quad">
    plotSvr('linear', svrL) <br> 

 </div>
 <img src="foto/svrlinear.png" width="70%" height="350px"><br> 


 <div class="quad">

 plotSvr('rbf', svrK) <br> 
 </div>

 <img src="foto/svrrbf.png" width="70%" height="350px"><br> 
 <div class="quad">


    plotSvr('Polinomial', svrP) <br> 

 </div> 
 <img src="foto/svrpoli.png" width="70%" height="350px"><br> 

 <b>KNN REGRESSION</b>
 <div class="quad">
 from sklearn.neighbors import KNeighborsRegressor <br> 
 <br> 
knn = KNeighborsRegressor(n_neighbors = 5, weights='uniform') <br> 
knn = KNeighborsRegressor(n_neighbors = 5, weights='distance') <br> 
knn.fit(x_train,y_train) <br> 

print('Coefficients: ', knn.metric_params,  '\n') <br> 
y_pred = knn.predict(x_test) <br> 
model = 'KNN' <br> 
plt.scatter(x_test,y_test,  color= 'red' ,label='data') <br> 
plt.plot(x_test, y_pred, 'or', label='prediction'  ,color='green') <br> 
plt.title('House Price Prediction %s' % model  , fontdict=title , pad=30) <br> 
plt.xticks([x_test.min(),x_test.mean(),x_test.max()]) <br> 
plt.yticks([y.min(),y.mean(),y.max()]) <br> 
plt.xlabel(input) <br> 
plt.ylabel(data.columns[-1]) <br> 
plt.tight_layout() <br> 
plt.show() <br> 

<br> 
# in rosso dati reali <br> 
# in verdi dati predetti  <br> 
 </div>
 <img src="foto/knnreg.png" width="70%" height="350px"><br> 

 <b>DECISION TREE REGRESSION</b><br> 
2 esecuzioni, una con max_depth a 2 e l'altra a 5 e nel grafico vediamo 
training data in rosso, previsione max_depth=2 in giallo e l'altro in blu




 <div class="quad">
    from sklearn.tree import DecisionTreeRegressor <br> 
    <br> 

    reg1 = DecisionTreeRegressor(max_depth=2) <br> 
    reg2 = DecisionTreeRegressor(max_depth=5) <br> 
    reg1.fit(x_train, y_train) <br> 
    reg2.fit(x_train, y_train) <br> 
    <br> 
    y1 = reg1.predict(x_test) <br> 
    y2 = reg2.predict(x_test) <br> 
    <br> 
    model ='DecisionTreeRegressor' <br> 
    <br> 
    
    plt.scatter(x_train,y_train,  color= 'red' ,label='data') <br> 
    plt.plot(x_test, y1, 'or', label='prediction1'  ,color='yellow') <br> 
    plt.plot(x_test, y2, 'or', label='prediction2'  ,color='blue') <br> 
    plt.title('House Price Prediction %s' % model  , fontdict=title , pad=30) <br> 
    plt.xticks([x_test.min(),x_test.mean(),x_test.max()]) <br> 
    plt.yticks([y.min(),y.mean(),y.max()]) <br> 
    plt.xlabel(input) <br> 
    plt.ylabel(data.columns[-1]) <br> 
    plt.tight_layout() <br> 
    plt.show() <br> 
    


 </div>
 <img src="foto/dctreg.png" width="70%" height="350px"><br> 
 
 <b>ENSEMBLE - BAGGING REGRESSION</b>
 <div class="quad">
    from sklearn.svm import SVR <br> 
    from sklearn.ensemble import BaggingRegressor <br> 
    <br> 
    
    reg = BaggingRegressor(base_estimator=SVR(), n_estimators=10, random_state=0).fit(x_train, y_train)
    <br> y_pred =  reg.predict(x_test) <br> 
    model = 'BaggingRegressor' <br> 
    plt.scatter(x_test,y_pred, marker = 'o') <br> 
    plt.plot(x_test, y_test, 'r+') <br> 
    plt.title('House Price Prediction %s' % model  , fontdict=title , pad=30) <br> 
    plt.xticks([x_test.min(),x_test.mean(),x_test.max()]) <br> 
    plt.yticks([y.min(),y.mean(),y.max()]) <br> 
    plt.xlabel(input) <br> 
    plt.ylabel(data.columns[-1]) <br> 
    <br> 
    plt.show() <br> 

 </div>
 <img src="foto/baggreg.png" width="70%" height="350px"><br> 

 <b>ENSEMBLE - RANDOM FOREST REGRESSION</b>
 <div class="quad">
    from sklearn.ensemble import RandomForestRegressor <br> 
    <br> 
    reg = RandomForestRegressor(max_depth=2, random_state=0).fit(x_train, y_train) <br> 
    <br> 
    y_pred =  reg.predict(x_test) <br> 
    <br> 
    model = 'RandomForestRegressor' <br> 
    plt.scatter(x_test,y_pred, marker = 'o') <br> 
    plt.plot(x_test, y_test, 'r+') <br> 
    plt.title('House Price Prediction %s' % model  , fontdict=title , pad=30) <br> 
    plt.xticks([x_test.min(),x_test.mean(),x_test.max()]) <br> 
    plt.yticks([y.min(),y.mean(),y.max()]) <br> 
    plt.xlabel(input) <br> 
    plt.ylabel(data.columns[-1]) <br> 
    <br> 
    plt.show() <br> 
 </div>
 <img src="foto/randomreg.png" width="70%" height="350px"><br> 
 <b>ENSEMBLE - ADABOOST REGRESSION</b>
 <div class="quad">
    from sklearn.ensemble import AdaBoostRegressor <br> 
    <br> 
    reg = AdaBoostRegressor(random_state=0, n_estimators=100).fit(x_train, y_train) <br> 
    <br> 
    y_pred =  reg.predict(x_test) <br> 
    <br> 
    model = 'AdaBoostRegressor' <br> 
    plt.scatter(x_test,y_pred, marker = 'o') <br> 
    plt.plot(x_test, y_test, 'r+') <br> 
    plt.title('House Price Prediction %s' % model  , fontdict=title , pad=30) <br> 
    plt.xticks([x_test.min(),x_test.mean(),x_test.max()]) <br> 
    plt.yticks([y.min(),y.mean(),y.max()]) <br> 
    plt.xlabel(input) <br> 
    plt.ylabel(data.columns[-1]) <br> 
    <br> 
    plt.show()
 </div>
 <img src="foto/adareg.png" width="70%" height="350px"><br> 

 <b>ENSEMBLE - DECISION TREE vs ADABOOST CON DECISIO TREE</b>
 <div class="quad">
    from sklearn.tree import DecisionTreeRegressor <br> 
    from sklearn.ensemble import AdaBoostRegressor <br> 
    <br> 
    reg1 = DecisionTreeRegressor(max_depth=4) <br> 
    reg2 = AdaBoostRegressor(DecisionTreeRegressor(max_depth=4), n_estimators=100, random_state=42)
    <br>  <br> 
    reg1.fit(x_train, y_train) <br> 
    reg2.fit(x_train, y_train) <br> 
    <br> 
    # Predict <br> 
    y1 = reg1.predict(x_test) <br> 
    y2 = reg2.predict(x_test) <br> 
    model = 'Decision Tree Regression with AdaBoost' <br> 
    # Plot the results <br> 
    plt.figure() <br> 
    plt.scatter(x_train, y_train, c="k", label="training") <br> 
    plt.plot(x_test, y1, 'bo' , c="g", label="Decision Tree", linewidth=1) <br> 
    plt.plot(x_test, y2, 'ro', c="r", label="Decision Tree - AdaBoost", linewidth=1) <br> 
    plt.title('House Price Prediction %s' % model  , fontdict=title , pad=30) <br> 
    plt.xticks([x_test.min(),x_test.mean(),x_test.max()]) <br> 
    plt.yticks([y.min(),y.mean(),y.max()]) <br> 
    plt.xlabel(input) <br> 
    plt.ylabel(data.columns[-1]) <br> 
    plt.legend() <br> 
    plt.show() <br> 


 </div>
 <img src="foto/decTadareg.png" width="70%" height="350px"><br> 

 <b>ENSEMBLE - GRADIENT BOOSTING REGRESSION</b>
 <div class="quad">
    from sklearn.ensemble import GradientBoostingRegressor  <br> 
    <br> 
    reg = GradientBoostingRegressor(random_state=0).fit(x_train, y_train)  <br> 
    <br> 
    y_pred =  reg.predict(x_test)  <br> 
    <br> 
    model = 'GradientBoostingRegressor'  <br> 
    plt.scatter(x_test,y_pred, marker = 'o')  <br> 
    plt.plot(x_test, y_test, 'r+')  <br> 
    plt.title('House Price Prediction %s' % model  , fontdict=title , pad=30)  <br> 
    plt.xticks([x_test.min(),x_test.mean(),x_test.max()])  <br> 
    plt.yticks([y.min(),y.mean(),y.max()])  <br> 
    plt.xlabel(input)  <br> 
    plt.ylabel(data.columns[-1])  <br> 
    
    plt.show()  <br> 
 </div>
 <img src="foto/gbreg.png" width="70%" height="350px"><br> 

 <b>ENSEMBLE - HIST GRADIENT BOOSTING REGRESSION - sperimentale </b>
 <div class="quad">
    from sklearn.experimental import enable_hist_gradient_boosting    <br> 
    from sklearn.ensemble import HistGradientBoostingRegressor  <br> 
    
    <br> 
    reg = HistGradientBoostingRegressor().fit(x_train, y_train)  <br> 
    reg.score(x_train, y_train)  <br> 
    <br> 
    
    y_pred =  reg.predict(x_test)  <br> 
    <br> 
    model = 'HistGradientBoostingRegressor'  <br> 
    plt.scatter(x_test,y_pred, marker = 'o')  <br> 
    plt.plot(x_test, y_test, 'r+')  <br> 
    plt.title('House Price Prediction %s' % model  , fontdict=title , pad=30)  <br> 
    plt.xticks([x_test.min(),x_test.mean(),x_test.max()])  <br> 
    plt.yticks([y.min(),y.mean(),y.max()])  <br> 
    plt.xlabel(input)  <br> 
    plt.ylabel(data.columns[-1])  <br> 
    <br> 
    plt.show()  <br> 
</div>
<img src="foto/histgbreg.png" width="70%" height="350px"><br> 

<b>ENSEMBLE - VOTING REGRESSION</b><br> 
Con Voting regression otteniamo una media degli altri regressor utilizzati
<div class="quad">
    from sklearn.ensemble import GradientBoostingRegressor  <br> 
    from sklearn.ensemble import RandomForestRegressor  <br> 
    from sklearn.linear_model import LinearRegression  <br> 
    from sklearn.ensemble import VotingRegressor  <br> 
    <br> 
    reg1 = GradientBoostingRegressor().fit(x_train, y_train)  <br> 
    reg2 = RandomForestRegressor().fit(x_train, y_train)  <br> 
    reg3 = LinearRegression().fit(x_train, y_train)  <br> 
    Vreg = VotingRegressor(estimators=[('gb', reg1), ('rf', reg2), ('lr', reg3)]).fit(x_train, y_train)  <br> 
    <br> 
    
    pred1 =  reg1.predict(x_test)  <br> 
    pred2 =  reg2.predict(x_test)  <br> 
    pred3 =  reg3.predict(x_test)  <br> 
    pred4 =  Vreg.predict(x_test)  <br> 
    
    <br> 
    model = 'VotingRegressor'  <br> 
    plt.figure()  <br> 
    plt.plot(pred1, 'g*', c="g", label="GradientBoostingRegressor")  <br> 
    plt.plot(pred2, 'r+', c="r", label="RandomForestRegressor")  <br> 
    plt.plot(pred3, 'yo', label="LinearRegression")  <br> 
    plt.plot(pred4, 'bo', label="VotingRegressor")  <br> 
    <br> 
    plt.legend(loc="best")  <br> 
    plt.title('House Price Prediction %s' % model  , fontdict=title , pad=30)  <br> 
    plt.xticks([x_test.min(),x_test.mean(),x_test.max()])  <br> 
    plt.yticks([y.min(),y.mean(),y.max()])  <br> 
    plt.xlabel(input)  <br> 
    plt.ylabel(data.columns[-1])  <br> 
    plt.legend(loc="best")  <br> 
    plt.show()  <br> 
    
</div>

<img src="foto/votingreg.png" width="70%" height="350px"><br> 

<b>NEURAL NETWORK REGRESSION</b>
<div class="quad">

    from sklearn.neural_network import MLPRegressor  <br> 
    <br> 
    reg = MLPRegressor(random_state=1, max_iter=10000).fit(x_train, y_train)  <br> 
    y_pred = reg.predict(x_test)  <br> 
    <br> 
    model = 'MLPRegressor'  <br> 
    plt.plot(x_test,y_pred, 'g*', label="Predicted")  <br> 
    plt.plot(x_test, y_test, 'r+', label="Test")  <br> 
    plt.title('House Price Prediction %s' % model  , fontdict=title , pad=30)  <br> 
    plt.xticks([x_test.min(),x_test.mean(),x_test.max()])  <br> 
    plt.yticks([y.min(),y.mean(),y.max()])  <br> 
    plt.xlabel(input)  <br> 
    plt.ylabel(data.columns[-1])  <br> 
    plt.legend(loc="best")  <br> 
    
    plt.show()  <br> 
</div>

<img src="foto/mlpreg.png" width="70%" height="350px"><br> 


<br>   <br> 