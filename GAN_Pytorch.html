<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0" />
    <meta name="google-site-verification" content="VXixwtxrf--qUV1swfStEg9jOGPKgUm6C3Ub_vouqmc" />
    <title>MecBar | The Mec Evolution </title>
    <link rel="icon" href="foto/favicon.ico"/>
    <!-- CSS  -->
    <link href="css/style.css" type="text/css" rel="stylesheet" media="screen,projection" />
    <link href="css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection" />
    
    <script src="js/jquery-3.js"></script>
    
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
   
    <link href="https://fonts.googleapis.com/css?family=Raleway|Satisfy" rel="stylesheet">
   

    <link href="css/style2.css" type="text/css" rel="stylesheet" media="screen,projection" />
    <link href="css/navbar.css" type="text/css" rel="stylesheet" media="screen,projection" />
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:ital@1&display=swap" rel="stylesheet"> 
</head>
<header>
    <nav>
        <li class="nav-wrapper back-home" id="head">
            <a href="http://www.mecbar.com/" class="brand-logo mecbar">
                <?xml version="1.0" encoding="UTF-8" standalone="no"?>
                <svg
                   xmlns:osb="http://www.openswatchbook.org/uri/2009/osb"
                   xmlns:dc="http://purl.org/dc/elements/1.1/"
                   xmlns:cc="http://creativecommons.org/ns#"
                   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
                   xmlns:svg="http://www.w3.org/2000/svg"
                   xmlns="http://www.w3.org/2000/svg"
                   xmlns:xlink="http://www.w3.org/1999/xlink"
                   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
                   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
                   width="156"
                   height="64"
                   viewBox="0 0 12.3825 5.08"
                   version="1.1"
                   id="svg8"
                   inkscape:version="1.0 (6e3e5246a0, 2020-05-07)"
                   sodipodi:docname="mecbar.svg">
                  <defs
                     id="defs2">
                    <linearGradient
                       osb:paint="solid"
                       id="linearGradient2948">
                      <stop
                         id="stop2946"
                         offset="0"
                         style="stop-color:#c6126a;stop-opacity:1;" />
                    </linearGradient>
                    <linearGradient
                       osb:paint="solid"
                       id="linearGradient875">
                      <stop
                         id="stop873"
                         offset="0"
                         style="stop-color:#babd06;stop-opacity:1;" />
                    </linearGradient>
                    <linearGradient
                       id="linearGradient3253"
                       osb:paint="solid">
                      <stop
                         style="stop-color:#878734;stop-opacity:1;"
                         offset="0"
                         id="stop3251" />
                    </linearGradient>
                    <linearGradient
                       inkscape:collect="always"
                       id="linearGradient3093">
                      <stop
                         style="stop-color:#c6126a;stop-opacity:1;"
                         offset="0"
                         id="stop3089" />
                      <stop
                         style="stop-color:#c6126a;stop-opacity:0;"
                         offset="1"
                         id="stop3091" />
                    </linearGradient>
                    <linearGradient
                       id="linearGradient3071"
                       osb:paint="solid">
                      <stop
                         style="stop-color:#c6126a;stop-opacity:1;"
                         offset="0"
                         id="stop3069" />
                    </linearGradient>
                    <rect
                       x="38.182308"
                       y="80.104469"
                       width="51.135052"
                       height="30.274338"
                       id="rect18630" />
                    <rect
                       x="160.31746"
                       y="77.487633"
                       width="134.35785"
                       height="60.829021"
                       id="rect18624" />
                    <rect
                       x="70.354279"
                       y="28.223705"
                       width="103.27115"
                       height="64.638908"
                       id="rect18618" />
                    <rect
                       x="32.55666"
                       y="25.199898"
                       width="5.2916665"
                       height="43.089287"
                       id="rect18612" />
                    <rect
                       x="34.029621"
                       y="65.792862"
                       width="93.441322"
                       height="26.673161"
                       id="rect18606" />
                    <rect
                       x="10.284417"
                       y="19.486744"
                       width="193.27823"
                       height="129.88597"
                       id="rect18596" />
                    <linearGradient
                       inkscape:collect="always"
                       xlink:href="#linearGradient3093"
                       id="linearGradient3101"
                       gradientUnits="userSpaceOnUse"
                       x1="3.1346149"
                       y1="23.792595"
                       x2="78.606865"
                       y2="23.792595" />
                    <filter
                       height="1"
                       y="-2.5183475e-16"
                       width="1"
                       x="-7.1910066e-17"
                       style="color-interpolation-filters:sRGB"
                       inkscape:label="Blend"
                       id="filter3198">
                      <feBlend
                         in2="SourceGraphic"
                         mode="multiply"
                         result="fbSourceGraphic"
                         id="feBlend3196" />
                      <feColorMatrix
                         result="fbSourceGraphicAlpha"
                         in="fbSourceGraphic"
                         values="0 0 0 -1 0 0 0 0 -1 0 0 0 0 -1 0 0 0 0 1 0"
                         id="feColorMatrix3200" />
                      <feBlend
                         in2="fbSourceGraphic"
                         id="feBlend3202"
                         mode="multiply"
                         result="blend"
                         in="fbSourceGraphic" />
                      <feGaussianBlur
                         id="feGaussianBlur869"
                         stdDeviation="6.7542215e-15" />
                    </filter>
                    <linearGradient
                       gradientUnits="userSpaceOnUse"
                       y2="9.1505461"
                       x2="228.5569"
                       y1="9.1505461"
                       x1="3.1346149"
                       id="linearGradient2950"
                       xlink:href="#linearGradient2948"
                       inkscape:collect="always" />
                    <linearGradient
                       y2="9.1505461"
                       x2="228.5569"
                       y1="9.1505461"
                       x1="3.1346149"
                       gradientTransform="translate(2.3455617,-9.683066)"
                       gradientUnits="userSpaceOnUse"
                       id="linearGradient3064"
                       xlink:href="#linearGradient2948"
                       inkscape:collect="always" />
                  </defs>
                  <sodipodi:namedview
                     id="base"
                     pagecolor="#ffffff"
                     bordercolor="#666666"
                     borderopacity="1.0"
                     inkscape:pageopacity="0.0"
                     inkscape:pageshadow="2"
                     inkscape:zoom="0.7"
                     inkscape:cx="355.19772"
                     inkscape:cy="45.714286"
                     inkscape:document-units="mm"
                     inkscape:current-layer="layer1-6"
                     inkscape:document-rotation="0"
                     showgrid="false"
                     inkscape:window-width="1324"
                     inkscape:window-height="747"
                     inkscape:window-x="36"
                     inkscape:window-y="21"
                     inkscape:window-maximized="1"
                     units="px"
                     inkscape:snap-nodes="true"
                     inkscape:object-paths="true"
                     scale-x="0.3" />
                  <metadata
                     id="metadata5">
                    <rdf:RDF>
                      <cc:Work
                         rdf:about="">
                        <dc:format>image/svg+xml</dc:format>
                        <dc:type
                           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
                        <dc:title></dc:title>
                      </cc:Work>
                    </rdf:RDF>
                  </metadata>
                  <g
                     inkscape:label="Layer 1"
                     inkscape:groupmode="layer"
                     class="io"
                     id="layer1">
                    <rect
                       ry="7.1295023"
                       rx="10.726023"
                       y="-2.8428149"
                       x="-4.4855061"
                       height="21.245117"
                       width="20.103241"
                       id="rect2824"
                       style="opacity:0;fill:#c6126a;stroke:#babd06;stroke-width:0.0794996;stroke-opacity:0.00424254" />
                    <g
                       inkscape:label="Layer 1"
                       id="layer1-6"
                       transform="matrix(0.16152221,0.0020121,0,0.13626925,0.08059628,0.86541284)"
                       style="mix-blend-mode:normal;fill:url(#linearGradient2950);fill-opacity:1;stroke-width:6.74038;filter:url(#filter3198);image-rendering:optimizeQuality">
                      <text
                         xml:space="preserve"
                         id="text18594"
                         style="font-style:normal;font-weight:normal;font-size:10.5833px;line-height:125%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18596);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <text
                         xml:space="preserve"
                         style="font-style:oblique;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:25.0978px;line-height:125%;font-family:Purisa;-inkscape-font-specification:'Purisa, Oblique';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;letter-spacing:0px;word-spacing:0px;fill:url(#linearGradient3064);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
                         x="-4.0898471"
                         y="24.876211"
                         id="text18602"
                         transform="matrix(0.75566848,-0.20637119,0.34609071,1.2288151,0,0)"><tspan
                   sodipodi:role="line"
                   id="tspan18600"
                   x="-4.0898471"
                   y="24.876211"
                   style="font-style:oblique;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:25.0978px;font-family:Purisa;-inkscape-font-specification:'Purisa, Oblique';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;fill:url(#linearGradient3064);fill-opacity:1;stroke-width:1.78339px">MecBar</tspan>        <animate
                   style="fill-opacity:1;fill:url(#linearGradient3064)"
                   begin="0s;light_2.end"
                   dur="1s"
                   values="1;0"
                   attributeName="fill-opacity"
                   id="light_1" />       <animate
                   style="fill-opacity:1;fill:url(#linearGradient3064)"
                   begin="light_1.end"
                   dur="1s"
                   values="0;1"
                   attributeName="fill-opacity"
                   id="light_2" />           </text>
                      <text
                         xml:space="preserve"
                         id="text18604"
                         style="font-style:normal;font-weight:normal;font-size:10.5833px;line-height:125%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18606);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <text
                         xml:space="preserve"
                         id="text18610"
                         style="font-style:normal;font-weight:normal;font-size:10.5833px;line-height:125%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18612);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <text
                         xml:space="preserve"
                         id="text18616"
                         style="font-style:normal;font-weight:normal;font-size:10.5833px;line-height:125%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18618);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <text
                         xml:space="preserve"
                         id="text18622"
                         style="font-style:normal;font-weight:normal;font-size:10.5833px;line-height:125%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18624);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <text
                         xml:space="preserve"
                         id="text18628"
                         style="font-style:normal;font-weight:normal;font-size:12.7px;line-height:125%;font-family:sans-serif;text-align:justify;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18630);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <animate
                         style="fill-opacity:1;fill:url(#linearGradient2950)"
                         begin="0s;light_2.end"
                         dur="1s"
                         values="1;0"
                         attributeName="fill-opacity"
                         id="light_1" />
                      <animate
                         style="fill-opacity:1;fill:url(#linearGradient2950)"
                         begin="light_1.end"
                         dur="1s"
                         values="0;1"
                         attributeName="fill-opacity"
                         id="light_2" />
                    </g>
                    <rect
                       ry="7.1295042"
                       rx="10.726021"
                       y="-2.8428149"
                       x="-4.4855061"
                       height="16.413473"
                       width="25.987757"
                       id="rect871"
                       style="opacity:0;fill:#c6126a;stroke:#babd06;stroke-width:0.0794996;stroke-opacity:0.00424254" />
                  </g>
                  <style
                     id="style43">
                           #tspan18600 {
                               
                              animation-name: mecOpacity;
                              animation-duration: 2s;
                              animation-iteration-count: infinite;
                              }
                              @keyframes mecOpacity {
                              0%   { fill-opacity:1 }
                                50%  {fill-opacity :0.1; }
                            100% { fill-opacity: 1; }
                              }
                    </style>
                </svg>
                </a>
            <a href="#" data-activates="mobile-demo" class="button-collapse"><i class="material-icons">menu</i></a>

            <ul class="right hide-on-med-and-down">
                <!--  <li> <a class="btn" onclick="Materialize.toast('Hello', 4000, 'Ciao' ,4000 )">Touch Me</a> </li>
              -->

              <li><a href="http://www.mecbar.com/#Ablog">Blog</a></li>
              <li><a href="http://www.mecbar.com/#Ablock">Blockchain</a></li>
              <li><a href="http://www.mecbar.com/#quantum">Quantum</a></li>
              <li><a href="http://www.mecbar.com/#Amachine">Machine Learning</a></li>
              <li><a href="http://www.mecbar.com/#Windows">Windows</a></li>
              <li><a href="http://www.mecbar.com/#Alinux">Linux</a></li>
              <li><a href="http://www.mecbar.com/#Aus">Contatti</a></li>
                <li>
                    <a href=""> </a>
                </li>
                <li>
                    <a href=""> </a>
                </li>
            </ul>
          
              <ul class="side-nav" id="mobile-demo">
               <li><a href="http://www.mecbar.com/#Ablog">Blog</a></li>
              <li><a href="http://www.mecbar.com/#Ablock">Blockchain</a></li>
                 <li><a href="http://www.mecbar.com/#quantum">Quantum</a></li>
              <li><a href="http://www.mecbar.com/#Amachine">Machine Learning</a></li>
              <li><a href="http://www.mecbar.com/#Windows">Windows</a></li>
              <li><a href="http://www.mecbar.com/#Alinux">Linux</a></li>
              <li><a href="http://www.mecbar.com/#Aus">Contatti</a></li>
            </ul>
        
            </li>
    </nav>
</header>
<style>
    .tasto-su {
            position: fixed;
            bottom: 15px;
            right: 8px;
            padding: 5px;
            background: rgb(2, 0, 0);
            color: white;
            border-radius: 10px;
            display:block;
            cursor: pointer;
            z-index: 5;
        }
   .tasto-su:hover {
            background:rgb(122, 2, 38);
            color :rgb(247, 247, 247);
        }

</style>

<body>
<div class="center titolo">
    <i>GENERATIVE ADVERSARIAL NETWORK - CREARE NUOVE IMMAGINI  </i>
 </div>
 <div class="testo">

Il Generative Adversarial Network è un modello di Deep Learning che ci permette di creare delle immagini che non esistevano inserendo in input 
un elenco di immagini reali.<br>
L'algoritmo è composta da 2 modelli, il primo il Generatore crea delle immagini nuove mentre il secondo 
il Discriminatore valuta se l'immagine creata è reale o falsa.<br>
Essendo entrambi reti neurali apprendono con la backpropagation in ogni iterazione aggiornando i weights ed i bias. 
<br>
Definiamo anche il latent space, un 100-dimensional hypersphere ovvero una sfera a 4 dimensioni.<br>
Il generatore ad ogni iterazione definisce nel latent space nuovi punti che rappresentano una nuova immagine.
<br>
Come vedremo ad ogni iterazione prenderemo dei numeri random per generare una nuova immagine nel latent space. 
Sotto un semplice esempio in python in Colab. <br>
<br><br>



Vediamo il codice per operare con TPU<br>
</div>
<div class="quad">
import os<br>
assert os.environ['COLAB_TPU_ADDR'], 'Make sure to select TPU from Edit > Notebook settings > Hardware accelerator'
<br>
!pip install cloud-tpu-client==0.10 https://storage.googleapis.com/tpu-pytorch/wheels/torch_xla-1.7-cp36-cp36m-linux_x86_64.whl

import torch<br>
import torch_xla<br>
import torch_xla.core.xla_model as xm<br>
device = xm.xla_device()<br>
device2 = xm.xla_device(n=2, devkind='TPU')<br>

</div>
<div class="testo">
   import delle librerie 
   </div>

<div class="quad">

import torchvision<br>
import torch.nn as nn<br>
import torch.nn.functional as F<br>
import torchvision.datasets as dset<br>
from torchvision import transforms<br>
from torchvision.datasets import ImageFolder<br>
from torchvision.utils import save_image<br>
from torchvision.utils import make_grid<br>
from torch.autograd import Variable<br>
from torch.utils.data import DataLoader<br>
import matplotlib.pyplot as plt<br>
%matplotlib inline<br>
</div>
<div class="testo">
definizione del modello G - generator
</div>

 </div>
<div class="quad">
   <span class="dot1">class Generator</span>(nn.Module):<br>
<span style="margin-left:30px"><span class="dot1">def</span> __init__(self):</span><br>
<span style="margin-left:60px">super(Generator, self).__init__()</span><br>
<span style="margin-left:60px">self.main = nn.Sequential(</span><br>
<span style="margin-left:90px"> nn.ConvTranspose2d(</span><br>
<span style="margin-left:120px"> 100, 512, kernel_size=4, </span><br>
 <span style="margin-left:120px"> stride=1, padding=0),</span><br>
<span style="margin-left:90px"> nn.BatchNorm2d(512),</span><br>
<span style="margin-left:90px"> nn.ReLU(True),</span><br>
 <span style="margin-left:90px"> nn.ConvTranspose2d(</span><br>
<span style="margin-left:120px"> 512, 256, kernel_size=4, </span><br>
<span style="margin-left:120px"> stride=2, padding=1),</span><br>
 <span style="margin-left:90px"> nn.BatchNorm2d(256),</span><br>
<span style="margin-left:90px"> nn.ReLU(True),</span><br>
 <span style="margin-left:90px"> nn.ConvTranspose2d(</span><br>
 <span style="margin-left:120px"> 256, 128, kernel_size=4, </span><br>
 <span style="margin-left:120px">  stride=2, padding=1),</span><br>
<span style="margin-left:90px"> nn.BatchNorm2d(128),</span><br>
<span style="margin-left:90px"> nn.ReLU(True),</span><br>
<span style="margin-left:90px"> nn.ConvTranspose2d(</span><br>
 <span style="margin-left:120px"> 128, 64, kernel_size=4, </span><br>
 <span style="margin-left:120px"> stride=2, padding=1),</span><br>
<span style="margin-left:90px"> nn.BatchNorm2d(64),</span><br>
<span style="margin-left:90px"> nn.ReLU(True),</span><br>
<span style="margin-left:90px"> nn.ConvTranspose2d(</span><br>
<span style="margin-left:120px"> 64, color, kernel_size=4, </span><br>
<span style="margin-left:120px"> stride=2, padding=1),</span><br>
<span style="margin-left:90px">  nn.Tanh()</span><br>
<span style="margin-left:120px"> )</span><br><br>
<span style="margin-left:30px"><span class="dot1">def </span>(self, input):</span><br>
   <span style="margin-left:90px">return self.main(input)</span><br>

</div>
<div class="testo">
   definizione del modello D - discriminator
   </div>
<div class="quad">
   <span class="dot1">lass Discriminator</span>(nn.Module):<br>
<span style="margin-left:30px"><span class="dot1">def </span>(self):</span><br>
<span style="margin-left:60px">super(Discriminator, self).__init__()</span><br>
<span style="margin-left:60px">self.main = nn.Sequential(</span><br>
<span style="margin-left:90px">nn.Conv2d(</span><br>
<span style="margin-left:120px"> color, 64, kernel_size=4, </span><br>
<span style="margin-left:120px"> stride=2, padding=1),</span><br>
<span style="margin-left:90px">nn.LeakyReLU(0.2, inplace=True),</span><br>
<span style="margin-left:90px">nn.Conv2d(</span><br>
 <span style="margin-left:120px"> 64, 128, kernel_size=4, </span><br>
 <span style="margin-left:120px"> stride=2, padding=1),</span><br>
 <span style="margin-left:90px">nn.BatchNorm2d(128),</span><br>
<span style="margin-left:90px">nn.LeakyReLU(0.2, inplace=True),</span><br>
 <span style="margin-left:90px">nn.Conv2d(</span><br>
 <span style="margin-left:120px"> 128, 256, kernel_size=4,</span><br> 
 <span style="margin-left:120px"> stride=2, padding=1),</span><br>
 <span style="margin-left:90px">nn.BatchNorm2d(256),</span><br>
 <span style="margin-left:90px">nn.LeakyReLU(0.2, inplace=True),</span><br>
 <span style="margin-left:90px">nn.Conv2d(</span><br>
 <span style="margin-left:120px"> 256, 512, kernel_size=4, </span><br>
 <span style="margin-left:120px"> stride=2, padding=1),</span><br>
 <span style="margin-left:90px"> nn.BatchNorm2d(512),</span><br>
 <span style="margin-left:90px">nn.LeakyReLU(0.2, inplace=True),</span><br>
 <span style="margin-left:90px">nn.Conv2d(</span><br>
 <span style="margin-left:120px"> 512, 1, kernel_size=4, </span><br>
 <span style="margin-left:120px"> stride=1, padding=0),</span><br>
 <span style="margin-left:90px">nn.Sigmoid()</span><br>
 <span style="margin-left:60px">)</span><br><br>
 <span style="margin-left:30px"><span class="dot1">def</span> forward(self, input):</span><br>
 <span style="margin-left:60px">return self.main(input)</span><br>
</div>
<div class="testo">
definizione parametri, loss function ed optimizer  <br>
</div>
<div class="quad">
torch.manual_seed(125)<br>
device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')<br>
lr = 0.0002<br>
batch_size = 16<br>
num_epochs = 700<br>
<br>
lossF = nn.BCELoss()<br>
<br>
optimizerD = torch.optim.Adam(discriminator.parameters(), lr=lr)<br>
optimizerG = torch.optim.Adam(generator.parameters(), lr=lr)<br>
</div>
<div class="testo">
download dataset celebrità lfw 
</div>
<div class="quad">

lfw_url = 'http://vis-www.cs.umass.edu/lfw/lfw-deepfunneled.tgz' <br>
root = 'lfw_dataset' <br>
if not os.path.exists(root): <br>
<span style="margin-left:30px"> os.makedirs(root)</span><br>
   <span style="margin-left:30px"> data_file = utils.download(lfw_url)</span><br>
      <span style="margin-left:30px"> with tarfile.open(data_file) as tar:</span><br>
         <span style="margin-left:60px"> tar.extractall(path=root)</span><br>
 <br>
dest = 'lfw'<br>
<br>
if not os.path.exists(dest):<br>
<span style="margin-left:30px"> os.makedirs(dest)</span><br>
<br>

for path, _, files in os.walk(root):<br>
<span style="margin-left:30px"> for file in files:</span><br>
<span style="margin-left:60px"> if file :</span><br>
 <span style="margin-left:90px"> shutil.copy(path + '/'+ file, '/content/lfw')</span><br>
 <br>

 root = '/content/'<br>
 my_dataset = dset.ImageFolder(root= root,<br>
 <span style="margin-left:30px">  transform=transforms.Compose([</span><br>
 <span style="margin-left:30px"> transforms.Resize(64),</span><br>
<span style="margin-left:30px"> transforms.CenterCrop(64),</span><br>
<span style="margin-left:30px"> transforms.ToTensor(),</span><br>
 <span style="margin-left:30px"> transforms.Normalize((0.5, 0.5, 0.5), (0.5, 0.5, 0.5)),</span><br>
<span style="margin-left:30px">  ]))</span><br>
<br>

train_data  = DataLoader(my_dataset, batch_size=batch_size,<br>
<span style="margin-left:30px"> shuffle=True, num_workers=4, drop_last= True)</span><br>
</div>

<div class="testo">
   visualizzazione immagini che verranno inserite nel modello nella fase di training
   </div>

<div class="quad">

for i in range(batch_size):<br>
<span style="margin-left:30px"> ax = plt.subplot(4, 4, i + 1)</span><br>
<span style="margin-left:30px"> plt.imshow(data_x[i].reshape(28, 28), cmap="gray_r")</span><br>
<span style="margin-left:30px">  plt.xticks([])</span><br>
<span style="margin-left:30px">  plt.yticks([])</span><br>
<br>
</div>
<div class="testo">
istanza dell'oggetto generator e discriminator ed assegnazione degli optimizer per i 2 modelli 
inoltre si definiscono le label 1 per immagini reali e 0 per le immagini fake. 
</div>
<div class="quad">
discriminator = Discriminator().to(device=device)<br>
generator = Generator().to(device=device)<br>
<br>
optimizerD = torch.optim.Adam(discriminator.parameters(), lr=lr)<br>
optimizerG = torch.optim.Adam(generator.parameters(), lr=lr)<br>
<br>
label = torch.full((batch_size,), 1.0, dtype=torch.float, device=device)<br>
fake_label = torch.full((batch_size,), 0.0, dtype=torch.float, device=device)<br><br>

</div>
<div class="testo">

training the GAN model  <br>
</div>

<div class="quad">
for epoch in range(num_epochs):<br>
<span style="margin-left:30px"> for n_train, x_train in enumerate(train_data):</span><br>
 <span style="margin-left:30px">latent_space = torch.randn(batch_size, 100, 1, 1, device=device)</span><br>
 <span style="margin-left:30px"><span class="dot1"># DISCRIMINATOR con real e fake images </span>(maximize log(D(x)) + log(1 - D(G(z)))) </span><br>
 <span style="margin-left:30px">## Train real images</span><br>
 <span style="margin-left:30px">discriminator.zero_grad()</span><br>
 <span style="margin-left:30px">real_data = x_train[0].to(device)</span><br>
 <span style="margin-left:30px"> real_dis = discriminator(real_data).view(-1)</span><br>
 <span style="margin-left:30px">lossD_real = lossF(real_dis, label)</span><br>
 <span style="margin-left:30px">lossD_real.backward()</span><br>
 <span style="margin-left:30px">## Train fake images </span><br>
<span style="margin-left:30px">fake = generator(latent_space)</span><br>
<span style="margin-left:30px">fake_dis = discriminator(fake.detach()).view(-1)</span><br>
<span style="margin-left:30px">lossD_fake = lossF(fake_dis, fake_label)</span><br>
<span style="margin-left:30px">lossD_fake.backward()</span><br>
 <span style="margin-left:30px">lossD = lossD_real + lossD_fake   </span><br>
<span style="margin-left:30px">optimizerD.step()</span><br>
   <br><br>
<span style="margin-left:30px"> <span class="dot1"># GENERATOR con real e fake images</span> (maximize log(D(x)) + log(1 - D(G(z))))  maximize log(D(G(z)))</span><br>
<span style="margin-left:30px">generator.zero_grad()</span><br>
<span style="margin-left:30px">dis_fake = discriminator(fake).view(-1)</span><br>
<span style="margin-left:30px">lossG = lossF(dis_fake, label)</span><br>
<span style="margin-left:30px">lossG.backward()</span><br>
<span style="margin-left:30px"> optimizerG.step()</span><br>
 <span style="margin-left:30px"> history_lossG.append(lossG.item())</span><br>
 <span style="margin-left:30px">history_lossD.append(lossD.item())</span><br>
 <span style="margin-left:30px">if n_train + 1 == batch_size :</span><br>
<span style="margin-left:90px">print(f"Epoch: {epoch} Loss Discriminator : {lossD: 3f}", f"Loss Generator : {lossG: 3f}")</span><br>

</div>



<br><br>

<button onclick="topFunction()" class="tasto-su" title="Go to top">Scroll-Top</button>
<script src="js/jquery-3.1.1.min.js"></script>
<script src="js/comandi.js"></script>
</body>
</html>
