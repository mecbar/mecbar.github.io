<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0" />
    <meta name="google-site-verification" content="VXixwtxrf--qUV1swfStEg9jOGPKgUm6C3Ub_vouqmc" />
    <title>MecBar | The Mec Evolution </title>
    <link rel="icon" href="foto/favicon.ico"/>
    <!-- CSS  -->
    <link href="css/style.css" type="text/css" rel="stylesheet" media="screen,projection" />
    <link href="css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection" />
    
    <script src="js/jquery-3.js"></script>
    
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
   
    <link href="https://fonts.googleapis.com/css?family=Raleway|Satisfy" rel="stylesheet">
   

    <link href="css/style2.css" type="text/css" rel="stylesheet" media="screen,projection" />
    <link href="css/navbar.css" type="text/css" rel="stylesheet" media="screen,projection" />
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:ital@1&display=swap" rel="stylesheet"> 
</head>
<header>
    <nav>
        <li class="nav-wrapper back-home" id="head">
            <a href="http://www.mecbar.com/" class="brand-logo mecbar">
                <?xml version="1.0" encoding="UTF-8" standalone="no"?>
                <svg
                   xmlns:osb="http://www.openswatchbook.org/uri/2009/osb"
                   xmlns:dc="http://purl.org/dc/elements/1.1/"
                   xmlns:cc="http://creativecommons.org/ns#"
                   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
                   xmlns:svg="http://www.w3.org/2000/svg"
                   xmlns="http://www.w3.org/2000/svg"
                   xmlns:xlink="http://www.w3.org/1999/xlink"
                   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
                   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
                   width="156"
                   height="64"
                   viewBox="0 0 12.3825 5.08"
                   version="1.1"
                   id="svg8"
                   inkscape:version="1.0 (6e3e5246a0, 2020-05-07)"
                   sodipodi:docname="mecbar.svg">
                  <defs
                     id="defs2">
                    <linearGradient
                       osb:paint="solid"
                       id="linearGradient2948">
                      <stop
                         id="stop2946"
                         offset="0"
                         style="stop-color:#c6126a;stop-opacity:1;" />
                    </linearGradient>
                    <linearGradient
                       osb:paint="solid"
                       id="linearGradient875">
                      <stop
                         id="stop873"
                         offset="0"
                         style="stop-color:#babd06;stop-opacity:1;" />
                    </linearGradient>
                    <linearGradient
                       id="linearGradient3253"
                       osb:paint="solid">
                      <stop
                         style="stop-color:#878734;stop-opacity:1;"
                         offset="0"
                         id="stop3251" />
                    </linearGradient>
                    <linearGradient
                       inkscape:collect="always"
                       id="linearGradient3093">
                      <stop
                         style="stop-color:#c6126a;stop-opacity:1;"
                         offset="0"
                         id="stop3089" />
                      <stop
                         style="stop-color:#c6126a;stop-opacity:0;"
                         offset="1"
                         id="stop3091" />
                    </linearGradient>
                    <linearGradient
                       id="linearGradient3071"
                       osb:paint="solid">
                      <stop
                         style="stop-color:#c6126a;stop-opacity:1;"
                         offset="0"
                         id="stop3069" />
                    </linearGradient>
                    <rect
                       x="38.182308"
                       y="80.104469"
                       width="51.135052"
                       height="30.274338"
                       id="rect18630" />
                    <rect
                       x="160.31746"
                       y="77.487633"
                       width="134.35785"
                       height="60.829021"
                       id="rect18624" />
                    <rect
                       x="70.354279"
                       y="28.223705"
                       width="103.27115"
                       height="64.638908"
                       id="rect18618" />
                    <rect
                       x="32.55666"
                       y="25.199898"
                       width="5.2916665"
                       height="43.089287"
                       id="rect18612" />
                    <rect
                       x="34.029621"
                       y="65.792862"
                       width="93.441322"
                       height="26.673161"
                       id="rect18606" />
                    <rect
                       x="10.284417"
                       y="19.486744"
                       width="193.27823"
                       height="129.88597"
                       id="rect18596" />
                    <linearGradient
                       inkscape:collect="always"
                       xlink:href="#linearGradient3093"
                       id="linearGradient3101"
                       gradientUnits="userSpaceOnUse"
                       x1="3.1346149"
                       y1="23.792595"
                       x2="78.606865"
                       y2="23.792595" />
                    <filter
                       height="1"
                       y="-2.5183475e-16"
                       width="1"
                       x="-7.1910066e-17"
                       style="color-interpolation-filters:sRGB"
                       inkscape:label="Blend"
                       id="filter3198">
                      <feBlend
                         in2="SourceGraphic"
                         mode="multiply"
                         result="fbSourceGraphic"
                         id="feBlend3196" />
                      <feColorMatrix
                         result="fbSourceGraphicAlpha"
                         in="fbSourceGraphic"
                         values="0 0 0 -1 0 0 0 0 -1 0 0 0 0 -1 0 0 0 0 1 0"
                         id="feColorMatrix3200" />
                      <feBlend
                         in2="fbSourceGraphic"
                         id="feBlend3202"
                         mode="multiply"
                         result="blend"
                         in="fbSourceGraphic" />
                      <feGaussianBlur
                         id="feGaussianBlur869"
                         stdDeviation="6.7542215e-15" />
                    </filter>
                    <linearGradient
                       gradientUnits="userSpaceOnUse"
                       y2="9.1505461"
                       x2="228.5569"
                       y1="9.1505461"
                       x1="3.1346149"
                       id="linearGradient2950"
                       xlink:href="#linearGradient2948"
                       inkscape:collect="always" />
                    <linearGradient
                       y2="9.1505461"
                       x2="228.5569"
                       y1="9.1505461"
                       x1="3.1346149"
                       gradientTransform="translate(2.3455617,-9.683066)"
                       gradientUnits="userSpaceOnUse"
                       id="linearGradient3064"
                       xlink:href="#linearGradient2948"
                       inkscape:collect="always" />
                  </defs>
                  <sodipodi:namedview
                     id="base"
                     pagecolor="#ffffff"
                     bordercolor="#666666"
                     borderopacity="1.0"
                     inkscape:pageopacity="0.0"
                     inkscape:pageshadow="2"
                     inkscape:zoom="0.7"
                     inkscape:cx="355.19772"
                     inkscape:cy="45.714286"
                     inkscape:document-units="mm"
                     inkscape:current-layer="layer1-6"
                     inkscape:document-rotation="0"
                     showgrid="false"
                     inkscape:window-width="1324"
                     inkscape:window-height="747"
                     inkscape:window-x="36"
                     inkscape:window-y="21"
                     inkscape:window-maximized="1"
                     units="px"
                     inkscape:snap-nodes="true"
                     inkscape:object-paths="true"
                     scale-x="0.3" />
                  <metadata
                     id="metadata5">
                    <rdf:RDF>
                      <cc:Work
                         rdf:about="">
                        <dc:format>image/svg+xml</dc:format>
                        <dc:type
                           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
                        <dc:title></dc:title>
                      </cc:Work>
                    </rdf:RDF>
                  </metadata>
                  <g
                     inkscape:label="Layer 1"
                     inkscape:groupmode="layer"
                     class="io"
                     id="layer1">
                    <rect
                       ry="7.1295023"
                       rx="10.726023"
                       y="-2.8428149"
                       x="-4.4855061"
                       height="21.245117"
                       width="20.103241"
                       id="rect2824"
                       style="opacity:0;fill:#c6126a;stroke:#babd06;stroke-width:0.0794996;stroke-opacity:0.00424254" />
                    <g
                       inkscape:label="Layer 1"
                       id="layer1-6"
                       transform="matrix(0.16152221,0.0020121,0,0.13626925,0.08059628,0.86541284)"
                       style="mix-blend-mode:normal;fill:url(#linearGradient2950);fill-opacity:1;stroke-width:6.74038;filter:url(#filter3198);image-rendering:optimizeQuality">
                      <text
                         xml:space="preserve"
                         id="text18594"
                         style="font-style:normal;font-weight:normal;font-size:10.5833px;line-height:125%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18596);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <text
                         xml:space="preserve"
                         style="font-style:oblique;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:25.0978px;line-height:125%;font-family:Purisa;-inkscape-font-specification:'Purisa, Oblique';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;letter-spacing:0px;word-spacing:0px;fill:url(#linearGradient3064);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
                         x="-4.0898471"
                         y="24.876211"
                         id="text18602"
                         transform="matrix(0.75566848,-0.20637119,0.34609071,1.2288151,0,0)"><tspan
                   sodipodi:role="line"
                   id="tspan18600"
                   x="-4.0898471"
                   y="24.876211"
                   style="font-style:oblique;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:25.0978px;font-family:Purisa;-inkscape-font-specification:'Purisa, Oblique';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;fill:url(#linearGradient3064);fill-opacity:1;stroke-width:1.78339px">MecBar</tspan>        <animate
                   style="fill-opacity:1;fill:url(#linearGradient3064)"
                   begin="0s;light_2.end"
                   dur="1s"
                   values="1;0"
                   attributeName="fill-opacity"
                   id="light_1" />       <animate
                   style="fill-opacity:1;fill:url(#linearGradient3064)"
                   begin="light_1.end"
                   dur="1s"
                   values="0;1"
                   attributeName="fill-opacity"
                   id="light_2" />           </text>
                      <text
                         xml:space="preserve"
                         id="text18604"
                         style="font-style:normal;font-weight:normal;font-size:10.5833px;line-height:125%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18606);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <text
                         xml:space="preserve"
                         id="text18610"
                         style="font-style:normal;font-weight:normal;font-size:10.5833px;line-height:125%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18612);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <text
                         xml:space="preserve"
                         id="text18616"
                         style="font-style:normal;font-weight:normal;font-size:10.5833px;line-height:125%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18618);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <text
                         xml:space="preserve"
                         id="text18622"
                         style="font-style:normal;font-weight:normal;font-size:10.5833px;line-height:125%;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18624);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <text
                         xml:space="preserve"
                         id="text18628"
                         style="font-style:normal;font-weight:normal;font-size:12.7px;line-height:125%;font-family:sans-serif;text-align:justify;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect18630);fill:url(#linearGradient2950);fill-opacity:1;stroke:none;stroke-width:1.78339px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;" />
                      <animate
                         style="fill-opacity:1;fill:url(#linearGradient2950)"
                         begin="0s;light_2.end"
                         dur="1s"
                         values="1;0"
                         attributeName="fill-opacity"
                         id="light_1" />
                      <animate
                         style="fill-opacity:1;fill:url(#linearGradient2950)"
                         begin="light_1.end"
                         dur="1s"
                         values="0;1"
                         attributeName="fill-opacity"
                         id="light_2" />
                    </g>
                    <rect
                       ry="7.1295042"
                       rx="10.726021"
                       y="-2.8428149"
                       x="-4.4855061"
                       height="16.413473"
                       width="25.987757"
                       id="rect871"
                       style="opacity:0;fill:#c6126a;stroke:#babd06;stroke-width:0.0794996;stroke-opacity:0.00424254" />
                  </g>
                  <style
                     id="style43">
                           #tspan18600 {
                               
                              animation-name: mecOpacity;
                              animation-duration: 2s;
                              animation-iteration-count: infinite;
                              }
                              @keyframes mecOpacity {
                              0%   { fill-opacity:1 }
                                50%  {fill-opacity :0.1; }
                            100% { fill-opacity: 1; }
                              }
                    </style>
                </svg>
                </a>
            <a href="#" data-activates="mobile-demo" class="button-collapse"><i class="material-icons">menu</i></a>

            <ul class="right hide-on-med-and-down">
                <!--  <li> <a class="btn" onclick="Materialize.toast('Hello', 4000, 'Ciao' ,4000 )">Touch Me</a> </li>
              -->

              <li><a href="http://www.mecbar.com/#Ablog">Blog</a></li>
              <li><a href="http://www.mecbar.com/#Ablock">Blockchain</a></li>
              <li><a href="http://www.mecbar.com/#quantum">Quantum</a></li>
              <li><a href="http://www.mecbar.com/#Amachine">Machine Learning</a></li>
              <li><a href="http://www.mecbar.com/#Windows">Windows</a></li>
              <li><a href="http://www.mecbar.com/#Alinux">Linux</a></li>
              <li><a href="http://www.mecbar.com/#Aus">Contatti</a></li>
                <li>
                    <a href=""> </a>
                </li>
                <li>
                    <a href=""> </a>
                </li>
            </ul>
          
              <ul class="side-nav" id="mobile-demo">
               <li><a href="http://www.mecbar.com/#Ablog">Blog</a></li>
              <li><a href="http://www.mecbar.com/#Ablock">Blockchain</a></li>
                 <li><a href="http://www.mecbar.com/#quantum">Quantum</a></li>
              <li><a href="http://www.mecbar.com/#Amachine">Machine Learning</a></li>
              <li><a href="http://www.mecbar.com/#Windows">Windows</a></li>
              <li><a href="http://www.mecbar.com/#Alinux">Linux</a></li>
              <li><a href="http://www.mecbar.com/#Aus">Contatti</a></li>
            </ul>
        
            </li>
    </nav>
</header>
<style>
    .quad {
        margin-top:50px;
        margin-bottom:50px; 
        border-radius: 5px;
        background-color: #f7f7f7;
        color :rgb(43, 37, 80);
        line-height:30px;
        border : 1px solid rgba(241, 241, 241, 0.932);
    }
    .quad:hover {
     filter:  drop-shadow(5px 4px 4px #e5e5e7);
     background-color: #ffffff;
     border : 1px solid rgba(209, 209, 208, 0.932);
     color :rgb(7, 7, 7);
    }
</style>

<body>
<div class="center titolo">
    <i> Machine Learning </i>
 </div>
 <div class="testo">


Con il Machine Learning abbiamo molti modelli per effettuare la classificazione di qualsiasi oggetti, documenti, 
foto, parole ecc. anche se con il Deep Learning si hanno altri strumenti anche pi√π performanti come la 
Convolutional Neural Network o un semplice Artificial Neural Network. <br>

Qui comunque vediamo i principali modelli di classificazione tra i quali:<br>
K-Nearest Neighbors (K-NN) - Logistic Regression - Support Vector Machine (SVM) -
Kernel SVM - Naive Bayes - Decision Tree Classification - Random Forest Classification - 
eXtreme Gradient Boosting<br>
<br>
Sotto si propongono degli esempi in Python. <br>

<br>
<div class="quad">
import numpy as np<br>
import matplotlib.pyplot as plt<br>
import pandas as pd<br>
from sklearn.model_selection import cross_val_score<br>
from sklearn.metrics import classification_report, plot_confusion_matrix, confusion_matrix, accuracy_score
</div>
<div class="quad">

bank = pd.read_csv('/content/drive/MyDrive/crypto/bank.csv')<br>

numero = range(1,len(bank)+1)<br>
num = pd.Series(numero)<br>
bank.insert(0, 'num' , num)<br>
   </div>

   <div class="quad">
bank2 = bank.iloc[:,:9]<br>
y = bank.iloc[:,-1]<br>
y = y.map({'yes': 1, 'no': 0})<br>
bank2.notnull()<br>
bank2.fillna(0)<br>
<br>
bank2 = bank2.replace(to_replace='yes', value = 1).replace(to_replace='no', value = 0)<br>
bank2 = bank2.replace(to_replace='primary', value = 1).replace(to_replace='secondary', value = 2)<br>
bank2 = bank2.replace(to_replace='tertiary', value = 3)<br>
bank2 = bank2.replace(to_replace=['married', 'management','unknown'], value = 0)<br>
bank2 = bank2.replace(to_replace=['single', 'technician',], value = 1)<br>
bank2 = bank2.replace(to_replace=['divorced', 'entrepreneur',], value = 2)<br>
bank2 = bank2.replace(to_replace='blue-collar', value = 3)<br>
bank2 = bank2.replace(to_replace='admin.', value = 4)<br>
bank2 = bank2.replace(to_replace='self-employed', value = 5)<br>
bank2 = bank2.replace(to_replace='student', value = 6)<br>
bank2 = bank2.replace(to_replace='retired', value = 7)<br>
bank2 = bank2.replace(to_replace='services', value = 8)<br>
bank2 = bank2.replace(to_replace='unemployed', value = 9)<br>
bank2 = bank2.replace(to_replace='housemaid', value = 10)<br>
</div>

<div class="quad">
X = bank2.iloc[:, :-1].values<br>
y = bank2.iloc[:, -1].values<br>
</div>
<div class="quad">
   from sklearn.linear_model import LogisticRegression<br>
   import matplotlib.pyplot as plt<br>
   import seaborn as sns<br>
   <br>
   clf = LogisticRegression(random_state=42).fit(X_train, y_train)<br>
   <br>
   y_pred = clf.predict(X_test)<br>
   <br>
   cm = confusion_matrix(y_test,y_pred)<br>

   print('Accuracy Logistic Regression : {:.2f} %'.format(clf.score(X_test,y_test)*100)) <br>
   modello = 'Logistic Regression HeatMap' <br>
   cmap = ['green', 'blue', 'red', 'yellow','brown', 'black'] <br>
   plt.figure(figsize= (10,8)) <br>
   plt.title(modello) <br>
   sns.heatmap(cm, annot=True,fmt='.7g',cmap=cmap ,cbar= True, robust=True ,linewidths=2.0) <br>
   <br>

   Accuracy Logistic Regression : 83.73 %
</div>
<br>
<img src="foto/logreg.png" width="80%" height="400px"><br>

<br>


<div class="quad">
from sklearn.model_selection import train_test_split<br>
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2, random_state = 0)<br>
<br>
from xgboost import XGBClassifier<br>
classifier = XGBClassifier()<br>
classifier.fit(X_train, y_train)<br>
<br>
from sklearn.metrics import confusion_matrix, accuracy_score, classification_report<br>
y_pred = classifier.predict(X_test)<br>
cm = confusion_matrix(y_test, y_pred)<br>
print(cm)<br>
print(accuracy_score(y_test, y_pred)*100 ,'%')<br>

<br><br>
[[7536   36]<br>
 [1405   66]]<br>
84.06502266946809 %<br>
<br>
print(classification_report(y_test, y_pred)) <br>
<br>
precision    recall  f1-score   support<br>
<br>
0       0.84      1.00      0.91      7572<br>
1       0.65      0.04      0.08      1471<br>
<br>
accuracy                           0.84      9043<br>
macro avg       0.74      0.52      0.50      9043<br>
weighted avg       0.81      0.84      0.78      9043<br>
<br>
</div>

Applying k-Fold Cross Validation<br>
<div class="quad">
accuracies = cross_val_score(estimator = classifier, X = X_train, y = y_train, verbose= 1, cv = 10)<br>
print("Accuracy: {:.2f} %".format(accuracies.mean()*100))<br>
print("Standard Deviation: {:.2f} %".format(accuracies.std()*100))<br>
print("Max Accuracy: {:.2f} %".format(accuracies.max()*100))    <br>
print("Min Accuracy: {:.2f} %".format(accuracies.min()*100)) <br>
<br>
Accuracy: 84.36 %<br>
Standard Deviation: 0.24 %<br>
Max Accuracy: 84.82 %<br>
Min Accuracy: 83.85 %<br>
</div>
<div class="quad">
from sklearn import svm<br>
cls_sv = svm.SVC()<br>
cls_sv.fit(X = X_train, y = y_train)<br>

<br>
accuracy = cross_val_score(estimator = cls_sv, X = X_train, y = y_train, verbose= 0, cv = 10)<br>
print("Accuracy: {:.2f} %".format(accuracy.mean()*100))<br>
print("Max Accuracy: {:.2f} %".format(accuracy.max()*100))    <br>
print("Min Accuracy: {:.2f} %".format(accuracy.min()*100)) <br>
print("Standard Deviation: {:.2f} %".format(accuracy.std()*100))<br>
<br>

Accuracy: 84.04 %<br>
Max Accuracy: 84.05 %<br>
Min Accuracy: 84.02 %<br>
Standard Deviation: 0.01 %<br>
</div>

Con la Class MLPClassifier creiamo in Multiplayer perceptron (MLP) algorithm - neural network<br>
<div class="quad">

from sklearn.neural_network import MLPClassifier<br>
clf = MLPClassifier(solver='lbfgs', alpha=1e-5,<br>
                hidden_layer_sizes=(15,), random_state=1)
                <br>
clf.fit(X = X_train, y = y_train)<br>
<br>

accuracy = cross_val_score(estimator = clf, X = X_train, y = y_train, verbose= 0, cv = 10)<br>
print("Accuracy: {:.2f} %".format(accuracy.mean()*100))<br>
print("Max Accuracy: {:.2f} %".format(accuracy.max()*100))   <br> 
print("Min Accuracy: {:.2f} %".format(accuracy.min()*100)) <br>
print("Standard Deviation: {:.2f} %".format(accuracy.std()*100))<br>
<br>
Accuracy: 83.94 %<br>
Max Accuracy: 84.05 %<br>
Min Accuracy: 83.72 %<br>
Standard Deviation: 0.12 %<br>
</div>

Ensemble methods<br>
<div class="quad">
from sklearn.ensemble import GradientBoostingClassifier<br>
<br>
clf = GradientBoostingClassifier(n_estimators=100, learning_rate=1.0,<br>
    max_depth=1, random_state=0)

clf.fit(X_train, y_train)<br>
print(clf.score(X_test, y_test))<br>

accuracy = cross_val_score(estimator = clf, X = X_train, y = y_train, verbose= 0, cv = 10)<br>
print("Accuracy: {:.2f} %".format(accuracy.mean()*100))<br>
print("Max Accuracy: {:.2f} %".format(accuracy.max()*100))    <br>
print("Min Accuracy: {:.2f} %".format(accuracy.min()*100)) <br>
print("Standard Deviation: {:.2f} %".format(accuracy.std()*100))<br>
<br>
0.8383279884993918<br>
Accuracy: 84.11 %<br>
Max Accuracy: 84.43 %<br>
Min Accuracy: 83.83 %<br>
Standard Deviation: 0.17 %<br>
</div>

<div class="quad">
from sklearn.ensemble import BaggingClassifier<br>
from sklearn.neighbors import KNeighborsClassifier<br>

clf = BaggingClassifier(KNeighborsClassifier(),<br>
                            max_samples=0.5, max_features=0.5)

clf.fit(X_train, y_train)<br>
print(clf.score(X_test, y_test))<br>
<br>
accuracy = cross_val_score(estimator = clf, X = X_train, y = y_train, verbose= 0, cv = 10)<br>
print("Accuracy: {:.2f} %".format(accuracy.mean()*100))<br>
print("Max Accuracy: {:.2f} %".format(accuracy.max()*100)) <br>   
print("Min Accuracy: {:.2f} %".format(accuracy.min()*100)) <br>
print("Standard Deviation: {:.2f} %".format(accuracy.std()*100))<br>
<br>
0.837996240185779<br>
Accuracy: 84.07 %<br>
Max Accuracy: 84.16 %<br>
Min Accuracy: 83.99 %<br>
Standard Deviation: 0.05 %<br>
</div>

<div class="quad">

from sklearn.ensemble import RandomForestClassifier<br>
<br>
clf = RandomForestClassifier(n_estimators=10)<br>
clf.fit(X_train, y_train)<br>
print(clf.score(X_test, y_test))<br>
<br>
accuracy = cross_val_score(estimator = clf, X = X_train, y = y_train, verbose= 0, cv = 10)<br>
print("Accuracy: {:.2f} %".format(accuracy.mean()*100))<br>
print("Max Accuracy: {:.2f} %".format(accuracy.max()*100))   <br> 
print("Min Accuracy: {:.2f} %".format(accuracy.min()*100)) <br>
print("Standard Deviation: {:.2f} %".format(accuracy.std()*100))<br>
<br>

0.8264956319805374<br>
Accuracy: 83.23 %<br>
Max Accuracy: 83.72 %<br>
Min Accuracy: 82.36 %<br>
Standard Deviation: 0.39 %<br>
<br>
</div>

<div class="quad">

from sklearn.tree import DecisionTreeClassifier<br>
<br>

clf = DecisionTreeClassifier(max_depth=None, min_samples_split=2,<br>
    random_state=0)

clf.fit(X_train, y_train)<br>
print(clf.score(X_test, y_test))<br>
<br>
accuracy = cross_val_score(estimator = clf, X = X_train, y = y_train, verbose= 0, cv = 10)<br>
print("Accuracy: {:.2f} %".format(accuracy.mean()*100))<br>
print("Max Accuracy: {:.2f} %".format(accuracy.max()*100))  <br>  
print("Min Accuracy: {:.2f} %".format(accuracy.min()*100)) <br>
print("Standard Deviation: {:.2f} %".format(accuracy.std()*100))<br>
<br>

0.7496406059935862<br>
Accuracy: 75.47 %<br>
Max Accuracy: 76.44 %<br>
Min Accuracy: 74.45 %<br>
Standard Deviation: 0.63 %<br>
</div>

<div class="quad">

from sklearn.ensemble import RandomForestClassifier<br>
<br>
clf = RandomForestClassifier(n_estimators=10, max_depth=None,<br>
    min_samples_split=2, random_state=0)
    <br>

clf.fit(X_train, y_train)<br>
print(clf.score(X_test, y_test))<br>
<br>
accuracy = cross_val_score(estimator = clf, X = X_train, y = y_train, verbose= 0, cv = 10)<br>
print("Accuracy: {:.2f} %".format(accuracy.mean()*100))<br>
print("Max Accuracy: {:.2f} %".format(accuracy.max()*100))    <br>
print("Min Accuracy: {:.2f} %".format(accuracy.min()*100)) <br>
print("Standard Deviation: {:.2f} %".format(accuracy.std()*100))<br>
<br>

0.8278226252349884<br>
Accuracy: 83.30 %<br>
Max Accuracy: 83.85 %<br>
Min Accuracy: 82.64 %<br>
Standard Deviation: 0.40 %<br>

</div>


<div class="quad">
from sklearn.ensemble import ExtraTreesClassifier<br>

clf = ExtraTreesClassifier(n_estimators=10, max_depth=None,<br>
    min_samples_split=2, random_state=0)

    <br>

clf.fit(X_train, y_train)<br>
print(clf.score(X_test, y_test))<br>
<br>
accuracy = cross_val_score(estimator = clf, X = X_train, y = y_train, verbose= 0, cv = 10)<br>
print("Accuracy: {:.2f} %".format(accuracy.mean()*100))<br>
print("Max Accuracy: {:.2f} %".format(accuracy.max()*100))   <br> 
print("Min Accuracy: {:.2f} %".format(accuracy.min()*100)) <br>
print("Standard Deviation: {:.2f} %".format(accuracy.std()*100))<br>

<br>
0.8193077518522615<br>
Accuracy: 82.38 %<br>
Max Accuracy: 82.83 %<br>
Min Accuracy: 81.92 %<br>
Standard Deviation: 0.29 %<br>
</div>


<div class="quad">
from sklearn.ensemble import AdaBoostClassifier<br>
<br>

clf = AdaBoostClassifier(n_estimators=100)<br>
clf.fit(X_train, y_train)<br>
print(clf.score(X_test, y_test))<br>
<br>
accuracy = cross_val_score(estimator = clf, X = X_train, y = y_train, verbose= 0, cv = 10)<br>
print("Accuracy: {:.2f} %".format(accuracy.mean()*100))<br>
print("Max Accuracy: {:.2f} %".format(accuracy.max()*100))  <br>  
print("Min Accuracy: {:.2f} %".format(accuracy.min()*100)) <br>
print("Standard Deviation: {:.2f} %".format(accuracy.std()*100))<br>
<br>
0.8376644918721663<br>
Accuracy: 84.07 %<br>
Max Accuracy: 84.21 %<br>
Min Accuracy: 83.88 %<br>
Standard Deviation: 0.11 %<br>
<br>
</div>

<div class="quad">
from sklearn.ensemble import GradientBoostingClassifier<br>
<br>

clf = GradientBoostingClassifier(n_estimators=100, learning_rate=1.0,<br>
    max_depth=1, random_state=0)

clf.fit(X_train, y_train)<br>
<br>
print(clf.score(X_test, y_test))<br>
<br>
accuracy = cross_val_score(estimator = clf, X = X_train, y = y_train, verbose= 0, cv = 10)<br>
print("Accuracy: {:.2f} %".format(accuracy.mean()*100))<br>
print("Max Accuracy: {:.2f} %".format(accuracy.max()*100))  <br>  
print("Min Accuracy: {:.2f} %".format(accuracy.min()*100)) <br>
print("Standard Deviation: {:.2f} %".format(accuracy.std()*100))<br>
<br>
<br>
0.8383279884993918<br>
Accuracy: 84.11 %<br>
Max Accuracy: 84.43 %<br>
Min Accuracy: 83.83 %<br>
Standard Deviation: 0.17 %<br>
</div>

<div class="quad">
from sklearn.experimental import enable_hist_gradient_boosting<br>
from sklearn.ensemble import HistGradientBoostingClassifier<br>

<br>
clf = HistGradientBoostingClassifier(max_iter=100)<br>
clf.fit(X_train, y_train)<br>
print(clf.score(X_test, y_test))<br>
<br>
accuracy = cross_val_score(estimator = clf, X = X_train, y = y_train, verbose= 0, cv = 10)<br>
print("Accuracy: {:.2f} %".format(accuracy.mean()*100))<br>
print("Max Accuracy: {:.2f} %".format(accuracy.max()*100))   <br> 
print("Min Accuracy: {:.2f} %".format(accuracy.min()*100)) <br>
print("Standard Deviation: {:.2f} %".format(accuracy.std()*100))<br>
<br>
0.8403184783810682<br>
Accuracy: 84.33 %<br>
Max Accuracy: 84.79 %<br>
Min Accuracy: 83.83 %<br>
Standard Deviation: 0.28 %<br>
</div>

Voting Classifier Hard<br>
<br>
<div class="quad">
from sklearn.naive_bayes import GaussianNB<br>
from sklearn.ensemble import RandomForestClassifier<br>
from sklearn.ensemble import VotingClassifier<br>
from sklearn.ensemble import AdaBoostClassifier<br>

<br>
clf1 = AdaBoostClassifier(n_estimators=100)<br>
clf2 = RandomForestClassifier(n_estimators=50, random_state=1)<br>
clf3 = GaussianNB()<br>
<br>
clfv = VotingClassifier(<br>
    estimators=[('ada', clf1), ('rf', clf2), ('gnb', clf3)],
    voting='hard')

for clf, classifier in zip([clf1, clf2, clf3, clfv], ['AdaBoost', 'Random Forest', 'naive Bayes', 'Ensemble']):<br>
    scores = cross_val_score(clf, X_train, y_train, scoring='accuracy', cv=10)
    print("Accuracy: %0.3f (Standard Deviation:  %0.3f) [%s]" % (scores.mean(), scores.std(), classifier))

    <br>
Accuracy: 0.841 (Standard Deviation:  0.001) [AdaBoost]<br>
Accuracy: 0.837 (Standard Deviation:  0.004) [Random Forest]<br>
Accuracy: 0.840 (Standard Deviation:  0.000) [naive Bayes]<br>
Accuracy: 0.842 (Standard Deviation:  0.001) [Ensemble]<br>
</div>


<br>
Voting Classifier Soft<br>

<br>

<div class="quad">
from sklearn.tree import DecisionTreeClassifier<br>
from sklearn.neighbors import KNeighborsClassifier<br>
from sklearn.svm import SVC<br>
from sklearn.ensemble import VotingClassifier<br>
<br>
clf1 = DecisionTreeClassifier(max_depth=4)<br>
clf2 = KNeighborsClassifier(n_neighbors=7)<br>
clf3 = SVC(kernel='poly', probability=True)<br>
clfv = VotingClassifier(estimators=[('dtc', clf1), ('knn', clf2), ('svm', clf3)],<br>
                        voting='soft', weights=[2, 1, 2])
                        <br>

for clf, classifier in zip([clf1, clf2, clf3, clfv], ['DecisionTree', 'KNN', 'SVM', 'Ensemble']):<br>
    scores = cross_val_score(clf, X_train, y_train, scoring='accuracy', cv=10)
print("[%s] Accuracy: %0.3f (Standard Deviation:  %0.3f) " % ( classifier, scores.mean(), scores.std()))
    <br>
    <br>
    [DecisionTree] Accuracy: 0.842 (Standard Deviation:  0.002)<br>
    [KNN] Accuracy: 0.831 (Standard Deviation:  0.003) <br>
    [SVM] Accuracy: 0.840 (Standard Deviation:  0.000) <br>
    [Ensemble]  Accuracy: 0.840 (Standard Deviation:  0.000) <br>
    <br>

    clf = GaussianNB()<br>
    clf.fit(X_train, y_train)<br>
    print(clf.score(X_test, y_test))<br>
    <br>
    accuracy = cross_val_score(estimator = clf, X = X_train, y = y_train, verbose= 0, cv = 10)<br>
    print("Accuracy: {:.2f} %".format(accuracy.mean()*100))<br>
    print("Max Accuracy: {:.2f} %".format(accuracy.max()*100))    <br>
    print("Min Accuracy: {:.2f} %".format(accuracy.min()*100)) <br>
    print("Standard Deviation: {:.2f} %".format(accuracy.std()*100))<br>
    <br>


    0.8373327435585536<br>
    Accuracy: 84.04 %<br>
    Max Accuracy: 84.05 %<br>
    Min Accuracy: 84.02 %<br>
    Standard Deviation: 0.01 %<br>
</div>
<div class="quad">
    from sklearn.naive_bayes import BernoulliNB <br>
    <br>
    clf = BernoulliNB()<br>
    clf.fit(X_train, y_train)<br>
    print(clf.score(X_test, y_test))<br>
    <br>
    accuracy = cross_val_score(estimator = clf, X = X_train, y = y_train, verbose= 0, cv = 10)<br>
    print("Accuracy: {:.2f} %".format(accuracy.mean()*100))<br>
    print("Max Accuracy: {:.2f} %".format(accuracy.max()*100))  <br>  
    print("Min Accuracy: {:.2f} %".format(accuracy.min()*100)) <br>
    print("Standard Deviation: {:.2f} %".format(accuracy.std()*100))<br>
    <br>
    y_pred = clf.predict(X_test)<br>
    <br>
    cm = confusion_matrix(y_test,y_pred)<br>
    import matplotlib.pyplot as plt<br>
    import seaborn as sns<br>
    <br>
    modello = 'Bernoulli Naive Baise Classification HeatMap'<br>
    cmap = ['red', 'blue', 'green', 'yellow','brown', 'black']<br>
    plt.figure(figsize= (10,8))<br>
    plt.title(modello)<br>
    sns.heatmap(cm, annot=True,fmt='.7g',cmap=cmap ,cbar= True, robust=True ,linewidths=2.0)<br>

    <br>
    0.8357845847616941<br>
Accuracy: 83.79 %<br>
Max Accuracy: 83.94 %<br>
Min Accuracy: 83.55 %<br>
Standard Deviation: 0.13 %<br>
</div>
<br>
<img src="foto/bernoulliclass.png" width="80%" height="400px"><br>

<br>

<div class="quad">

from sklearn.decomposition import PCA<br>
pca = PCA(n_components=2)<br><br>

from sklearn.preprocessing import StandardScaler<br>
sc = StandardScaler()<br>
x_train = sc.fit_transform(X_train)<br>
x_test = sc.transform(X_test)<br>
pca.fit(x_train)<br>
x_train = pca.transform(x_train)<br>
<br>
from sklearn.naive_bayes import BernoulliNB <br>

clf = BernoulliNB()<br>
clf.fit(x_train,y_train)<br>

<br>
headerI = [ x for x in bank2.columns ] # header input<br>
comp = pca.n_components_<br>
index_comp = [np.abs(pca.components_[i]).argmax() for i in range(comp)]<br>
# cerco index columns selezionata <br>
input1 = headerI[index_comp[0]]<br>
input2 = headerI[index_comp[1]]<br>

<br>

from matplotlib.colors import ListedColormap<br>
<br>
x1, x2 = np.meshgrid(np.arange(start =  x_train[:, 0].min() - 1, stop =  x_train[:, 0].max() + 1, step = 0.01),<br>
                     np.arange(start =  x_train[:, 1].min() - 1, stop =  x_train[:, 1].max() + 1, step = 0.01))
plt.contourf(x1, x2, clf.predict(np.array([x1.ravel(), x2.ravel()]).T).reshape(x1.shape),<br>
             alpha = 0.15, cmap = ListedColormap(('black', 'red')))
plt.xlim(x1.min(), x1.max())<br>
plt.ylim(x2.min(), x2.max())<br>
for i, j in enumerate(np.unique( y_train)):<br>
    plt.scatter( x_train[y_train == j, 0],  x_train[y_train == j, 1],
                color = ListedColormap(('black','red'))(i), label = j)
plt.title('Bernoulli Naive Baise Classification(Training set)')<br>
plt.xlabel(input1)<br>
plt.ylabel(input2)<br>
plt.legend()<br>
plt.show()<br>
</div>




<br>
<img src="foto/bernoulliclass2.png" width="70%" height="400px"><br>

<br>
<div class="quad">
import numpy as np<br>
import matplotlib.pyplot as plt<br>
import seaborn as sns<br>
from matplotlib.colors import ListedColormap<br>
from sklearn.ensemble import AdaBoostClassifier<br>
<br>
X, y = x_train, y_train<br>
<br>



h = .05  # step size  for mesh <br>
<br>
cmap_light = ListedColormap(['yellow'])<br>
cmap_bold = ['black', 'blue']<br>
<br>

clf = AdaBoostClassifier(n_estimators=100)<br>

clf.fit(X, y)<br>
<br>
x_min, x_max = X[:, 0].min() - 1, X[:, 0].max() + 1<br>
y_min, y_max = X[:, 1].min() - 1, X[:, 1].max() + 1<br>
xx, yy = np.meshgrid(np.arange(x_min, x_max, h),<br>
                         np.arange(y_min, y_max, h))<br>
Z = clf.predict(np.c_[xx.ravel(), yy.ravel()])<br>

<br>
Z = Z.reshape(xx.shape)<br>
plt.figure(figsize=(8, 6))<br>
plt.contourf(xx, yy, Z, cmap=cmap_light)<br>
<br>
sns.scatterplot(x=X[:, 0], y=X[:, 1], hue=y, palette=cmap_bold, alpha=1.0, edgecolor="black")<br>
plt.xlim(xx.min(), xx.max())<br>
plt.ylim(yy.min(), yy.max())<br>
plt.title('AdaBoostClassifier Classification(Training set)')<br>
plt.xlabel(input1)<br>
plt.ylabel(input2)<br>

plt.show()<br>
</div>
<br>
<img src="foto/adaboost.png" width="80%" height="400px"><br>

<br>
<div class="quad">
from sklearn.linear_model import SGDClassifier<br>
from sklearn.preprocessing import StandardScaler<br>
from sklearn.pipeline import Pipeline<br>
sgd = SGDClassifier()<br>
scaler = StandardScaler()<br>
clf = Pipeline([('scaler', scaler), ('sgd', sgd)])<br>
<br>

clf.fit(X_train, y_train)<br>

<br>


accuracy = cross_val_score(estimator = clf, X = X_train, y = y_train, verbose= 0, cv = 10)<br>
print("Accuracy: {:.2f} %".format(accuracy.mean()*100))<br>
print("Max Accuracy: {:.2f} %".format(accuracy.max()*100))   <br> 
print("Min Accuracy: {:.2f} %".format(accuracy.min()*100)) <br>
print("Standard Deviation: {:.2f} %".format(accuracy.std()*100))<br>
<br>
y_pred = clf.predict(X_test)<br>

cm = confusion_matrix(y_test,y_pred)<br>
import matplotlib.pyplot as plt<br>
import seaborn as sns<br>
<br>
plt.figure(figsize= (10,7))<br>
sns.heatmap(cm, annot=True,fmt='.5g'  )<br>
<br>
Accuracy: 84.04 %<br>
Max Accuracy: 84.05 %<br>
Min Accuracy: 84.02 %<br>
Standard Deviation: 0.01 %<br>
</div>
<br>
<img src="foto/sgdclass.png" width="70%" height="400px"><br>

<br>
<div class="quad">
import numpy as np<br>
import matplotlib.pyplot as plt<br>
import seaborn as sns<br>
from matplotlib.colors import ListedColormap<br>
from sklearn.linear_model import SGDClassifier<br>
from sklearn.model_selection import train_test_split<br>
from sklearn.preprocessing import StandardScaler<br>
from sklearn.decomposition import PCA<br>
<br>

clf = SGDClassifier()<br>

h = .03  # step size in the mesh<br>
<br>



X = bank2.iloc[:, :-1].values<br>
y = bank2.iloc[:, -1].values<br>
<br>
pca = PCA(n_components=3)<br>
<br>
sc = StandardScaler()<br>
<br>
X = sc.fit_transform(X)<br>
#x_test = sc.transform(X_test)<br>
pca.fit(X)<br>
X = pca.transform(X)<br>

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=.2, random_state=42)<br>
clf.fit(X_train, y_train)<br>

x_min, x_max = X[:, 0].min() - 1, X[:, 0].max() + 1<br>
y_min, y_max = X[:, 1].min() - 1, X[:, 1].max() + 1<br>
z_min, z_max = X[:, 2].min() - 1, X[:, 2].max() + 1<br>
xx, yy ,zz = np.meshgrid(np.arange(x_min, x_max, h),<br>
                     np.arange(y_min, y_max, h),
                      np.arange(z_min, z_max, h)         )
                      <br>

cm = plt.cm.RdBu<br>
cm_bright = ListedColormap([ '#ffffff', '#0000FF','#660055'])<br>
cm.monochrome<br>
<br>
headerI = [ x for x in bank2.columns ] # header input<br>
comp = pca.n_components_<br>
index_comp = [np.abs(pca.components_[i]).argmax() for i in range(comp)]<br>
# cerco index columns selezionata <br>
input1 = headerI[index_comp[0]]<br>
input2 = headerI[index_comp[1]]<br>
input3 = headerI[index_comp[2]]<br>

df = pd.DataFrame(X_test, columns=[input1,input2,input3])<br>

import plotly.express as pe<br>
<br>
fig = pe.scatter_3d(df, x=input1, y=input2 ,z=input3,color=y_test, title='Bank client classification Model', width=900)<br>
fig.show()<br>
</div>

<br>
<img src="foto/sgd3d.png" width="100%" height="400px"><br>

<br>